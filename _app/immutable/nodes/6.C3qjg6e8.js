import{e as U,a as y,t as k,s as O,h as Vn,b as Hn,c as Ft}from"../chunks/disclose-version.B0B114Pu.js";import{i as an}from"../chunks/legacy.DQ3BPbVs.js";import{p as nn,b as on,c as d,s as _,d as s,r,g as t,t as g,m as S,l as ot,a as Yn,f as z,$ as Qn,j as q,h as X,n as ma,i as zt}from"../chunks/runtime.mdILdFMH.js";import{c as Jn,o as rn,i as E}from"../chunks/index-client.T9W-Qjf4.js";import{e as Ot,i as Ct}from"../chunks/each.CSPNoT9w.js";import{r as ln,c as Ya,s as Qa}from"../chunks/_layout.B2jEg47M.js";import{c as te,A as le,S as qn,a as Xn,s as ne,h as ct,b as oe,d as Zn,f as to,e as eo,r as ao,E as no,B as Ja,q as qa,t as oo,P as ro,x as io,y as Xa}from"../chunks/Progress.sJimGKi_.js";import{b as sn}from"../chunks/misc.CV3rZvPR.js";import{b as Ut,m as lo,r as Za,s as so,a as co,c as uo,d as re,e as mo,f as vo}from"../chunks/kpi.CTeKY0Fk.js";import{p as jt,s as Zt}from"../chunks/event-modifiers.BCjtW8R-.js";import{b as fo}from"../chunks/misc.CtkO2lJ8.js";import{C as _o}from"../chunks/ConflictRouteTabs.B_9-Me3P.js";import{a as po,s as bo}from"../chunks/containerSetup.bmmcM5eb.js";import{t as cn}from"../chunks/warWeb.da6xX1jT.js";import{p as ie}from"../chunks/props.C-lgak6u.js";function Qt(K,N,T,w,mt){let Bt=K.coalitions,Wt=K.damage_header,Z=K.header_type,tt=[],D=[],et=[],j=[],$={},gt=null;switch(N){case 0:gt=null;break;case 1:gt=null;break;case 2:gt=null;break}D.push("name");for(let c=0;c<Wt.length;c++){let B=cn(Wt[c]),F=Z[c];F==0?(D.push(`loss:${B}`),D.push(`dealt:${B.replace("_loss","").replace("loss_","")}`),D.push(`net:${B.replace("_loss","").replace("loss_","")}`)):F==1&&(D.push(`def:${B}`),D.push(`off:${B}`),D.push(`both:${B}`))}et.push(0),N===0?$.formatCol=[0]:N===1?$.formatAA=[0]:N===2&&($.formatNation=[0]);let ht=[Math.max(0,D.indexOf(w)),mt];$.formatNumber=[],$.formatMoney=[];for(let c=0;c<D.length;c++)T.includes(D[c])&&j.push(c),c>0&&(D[c].includes("~")||D[c].includes("damage")||D[c].includes("infra")&&!D[c].includes("attacks")?$.formatMoney.push(c):$.formatNumber.push(c));let rt=(c,B,F)=>{for(let u=0;u<B.length;u++){let C=B[u],V=F[u],Nt=Z[u],Y;Nt==0?Y=V-C:Y=V+C,c.push(C),c.push(V),c.push(Y)}},xt=(c,B)=>{let F=c.alliance_ids,u=c.alliance_names,C=c.nation_ids,V=c.nation_names,Nt=c.nation_aa,Y=c.damage;switch(N){case 0:let yt=[B];rt(yt,Y[0],Y[1]),tt.push(yt);break;case 1:let $t=2;for(let I=0;I<F.length;I++){let vt=[],Gt=F[I],Jt=te(u[I],Gt);vt.push([Jt,Gt]),rt(vt,Y[I*2+$t],Y[I*2+$t+1]),tt.push(vt)}break;case 2:let Tt=2+F.length*2;for(let I=0;I<C.length;I++){let vt=[],Gt=C[I],Jt=V[I],ft=Nt[I];vt.push([Jt,Gt,ft]),rt(vt,Y[I*2+Tt],Y[I*2+Tt+1]),tt.push(vt)}break}};for(let c=0;c<Bt.length;c++){let B=Bt[c];xt(B,c)}return{columns:D,data:tt,visible:j,searchable:et,cell_format:$,row_format:gt,sort:ht}}var go=Object.defineProperty,ho=Object.defineProperties,yo=Object.getOwnPropertyDescriptors,tn=Object.getOwnPropertySymbols,Io=Object.prototype.hasOwnProperty,xo=Object.prototype.propertyIsEnumerable,en=(K,N,T)=>N in K?go(K,N,{enumerable:!0,configurable:!0,writable:!0,value:T}):K[N]=T,No=(K,N)=>{for(var T in N||(N={}))Io.call(N,T)&&en(K,T,N[T]);if(tn)for(var T of tn(N))xo.call(N,T)&&en(K,T,N[T]);return K},Ao=(K,N)=>ho(K,yo(N));function va(K){const N=`${le()}:presets`;try{const T=localStorage.getItem(N);if(!T)return{};const w=JSON.parse(T);return!w||typeof w!="object"?{}:w}catch(T){return console.warn("Failed to read column presets",T),{}}}function So(K,N,T){const w=`${le()}:presets`;try{const mt=va(T);mt[K]=Ao(No({},N),{createdAt:Date.now()}),localStorage.setItem(w,JSON.stringify(mt))}catch(mt){console.warn("Failed to save column preset",mt)}}function ko(K,N){const T=`${le()}:presets`;try{const w=va(N);Object.prototype.hasOwnProperty.call(w,K)&&(delete w[K],localStorage.setItem(T,JSON.stringify(w)))}catch(w){console.warn("Failed to delete column preset",w)}}var wo=k('<div class="small text-muted px-2">No saved layouts</div>'),Oo=k('<div class="preset-item px-2 py-1 small svelte-1040e6o"><div class="text-truncate" style="max-width:140px"> </div> <div><button class="btn ux-btn btn-sm me-1">Load</button> <button class="btn btn-sm btn-outline-danger">Delete</button></div></div>'),Co=k('<div class="dropdown d-inline"><button class="btn ux-btn btn-sm" type="button" id="cpDropdown" data-bs-toggle="dropdown" aria-expanded="false">My layouts&nbsp;<i class="bi bi-chevron-down"></i></button> <div class="dropdown-menu p-2" aria-labelledby="cpDropdown" style="min-width:260px;"><div class="input-group input-group-sm mb-2"><input class="form-control form-control-sm" placeholder="Save current as..."> <button class="btn ux-btn btn-sm">Save</button></div> <hr class="dropdown-divider"> <div class="preset-list svelte-1040e6o"><!> <!></div></div></div>');function $o(K,N){nn(N,!1);let T=ie(N,"currentColumns",24,()=>[]),w=ie(N,"currentSort",8,""),mt=ie(N,"currentOrder",8,"desc"),Bt=ie(N,"currentKpis",24,()=>[]),Wt=ie(N,"currentKpiConfig",8,null);const Z=Jn();let tt=S({}),D=S("");function et(){_(tt,va())}rn(et);function j(){const C=(t(D)||"").trim();if(!C){Z("error",{message:"Name required"});return}t(tt)[C]&&!confirm(`Overwrite layout "${C}"?`)||(So(C,{columns:T(),sort:w(),order:mt(),kpis:Bt(),kpiConfig:Wt()}),_(D,""),et(),Z("saved",{name:C}))}function $(C){const V=t(tt)[C];V&&Z("load",{name:C,preset:V})}function gt(C){confirm(`Delete layout "${C}"?`)&&(ko(C),et(),Z("deleted",{name:C}))}an();var G=Co(),ht=d(s(G),2),rt=s(ht),xt=s(rt);ln(xt);var c=d(xt,2);r(rt);var B=d(rt,4),F=s(B);E(F,()=>Object.keys(t(tt)).length===0,C=>{var V=wo();y(C,V)});var u=d(F,2);Ot(u,1,()=>Object.keys(t(tt)),Ct,(C,V)=>{var Nt=Oo(),Y=s(Nt),yt=s(Y,!0);r(Y);var $t=d(Y,2),Tt=s($t),I=d(Tt,2);r($t),r(Nt),g(()=>O(yt,t(V))),U("click",Tt,()=>$(t(V))),U("click",I,()=>gt(t(V))),y(C,Nt)}),r(B),r(ht),r(G),sn(xt,()=>t(D),C=>_(D,C)),U("click",c,j),y(K,G),on()}var To=Hn('<script id="visjs" async src="https://cdnjs.cloudflare.com/ajax/libs/vis-timeline/7.7.3/vis-timeline-graph2d.min.js"><\/script><!---->',1),Ro=k('<a class="btn ux-btn fw-bold"> <i class="bi bi-box-arrow-up-right"></i></a>'),Lo=k("<li><button> </button></li>"),Eo=k('<li><button class="btn ux-btn btn-sm">Show KPI</button></li>'),Po=k('<div class="small text-muted mb-2">No cards</div>'),Ko=k('<div class="d-flex align-items-center justify-content-between gap-2 mb-1"><span class="small text-truncate"> </span> <div class="d-flex gap-1"><button type="button" class="btn btn-sm btn-outline-secondary">↑</button> <button type="button" class="btn btn-sm btn-outline-secondary">↓</button> <button type="button" class="btn btn-sm btn-outline-danger">Remove</button></div></div>'),Do=k('<button type="button" class="btn btn-sm btn-outline-secondary"> </button>'),Mo=k("<option> </option>"),Fo=k("<option> </option>"),zo=k("<option> </option>"),Uo=k('<a class="btn btn-sm btn-outline-secondary w-100 mt-1">Add AAvA widgets from the AAvA page</a>'),jo=k('<div class="small text-muted">Duration</div> <div class="h6 m-0"> </div>',1),Bo=k('<div class="small text-muted">Wars tracked</div> <div class="h6 m-0"> </div>',1),Wo=k('<div class="small text-muted">Total damage exchanged</div> <div class="h6 m-0"> </div>',1),Go=k('<div class="small text-muted"> </div>'),Vo=k('<div class="small text-muted">Damage gap</div> <div class="h6 m-0"> </div> <!>',1),Ho=k('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),Yo=k('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),Qo=k('<div class="small text-muted"> </div>'),Jo=k('<div class="small text-muted">Participation</div> <div class="h6 m-0"> </div> <!>',1),qo=k("<th>Alliance</th>"),Xo=k("<td> </td>"),Zo=k('<tr><td></td><td> </td><!><td class="text-end"> </td></tr>'),tr=k('<div class="small text-muted mb-1"> </div> <div class="table-responsive"><table class="table table-sm table-striped m-0"><thead><tr><th>#</th><th> </th><!><th class="text-end">Value</th></tr></thead><tbody></tbody></table></div>',1),er=k('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),ar=k('<div><div class="ux-surface p-3 rounded border h-100 position-relative kpi-card" role="group" draggable="true"><button type="button" class="btn-close kpi-card-close" aria-label="Remove KPI card"></button> <!></div></div>'),nr=k('<div class="ux-surface p-2 mb-3 rounded border"><div class="d-flex align-items-center justify-content-between mb-2"><h5 class="m-0">KPI</h5> <button type="button" class="btn-close" aria-label="Hide KPI"></button></div> <div class="row g-2"></div></div>'),or=k('<div class="alert alert-danger m-2 d-flex justify-content-between align-items-center"><span> </span> <button class="btn btn-sm btn-outline-danger fw-bold">Retry</button></div>'),rr=k('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Casus Belli</h3> <pre> </pre></div></div>'),ir=k('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Status</h3> <pre> </pre></div></div>'),lr=k('<hr> <div class="row m-0"><!> <!></div>',1),sr=k('<div class="small text-muted text-end mt-2"> </div>'),cr=k('<div class="container-fluid p-2 ux-page-body"><h1 class="m-0 mb-2 p-2 ux-surface ux-page-title"><a href="conflicts" aria-label="Back to conflicts"><i class="bi bi-arrow-left"></i></a> <!></h1> <!> <ul class="layout-picker-bar ux-floating-controls nav fw-bold nav-pills m-0 p-2 ux-surface mb-3 d-flex flex-wrap gap-1"><li class="me-1">Layout Picker:</li> <!> <li><!></li> <!> <li class="dropdown ms-auto" data-bs-auto-close="outside"><button class="btn ux-btn btn-sm" type="button" id="kpiManagerDropdown" data-bs-toggle="dropdown" aria-expanded="false">KPI widgets&nbsp;<i class="bi bi-chevron-down"></i></button> <div class="dropdown-menu p-2" aria-labelledby="kpiManagerDropdown" style="min-width: 340px;"><div class="small text-muted mb-1">KPI cards</div> <!> <!> <hr class="dropdown-divider"> <div class="small text-muted mb-1">Preset cards</div> <div class="d-flex flex-wrap gap-1 mb-2"></div> <hr class="dropdown-divider"> <div class="small text-muted mb-1">Ranking cards</div> <div class="row g-1 mb-2"><div class="col-4"><select class="form-select form-select-sm"><option>Alliance</option><option>Nation</option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>All</option><option>Coalition 1</option><option>Coalition 2</option><option> </option></select></div> <div class="col-4"><input class="form-control form-control-sm" type="number" min="1"></div> <div class="col-12"><select class="form-select form-select-sm"></select></div> <div class="col-12"><button type="button" class="btn btn-sm btn-outline-secondary w-100">+ Add ranking card</button></div></div> <hr class="dropdown-divider"> <div class="small text-muted mb-1">Metric cards</div> <div class="row g-1"><div class="col-4"><select class="form-select form-select-sm"><option>Alliance</option><option>Nation</option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>All</option><option>Coalition 1</option><option>Coalition 2</option><option> </option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>Sum</option><option>Avg</option></select></div> <div class="col-12"><select class="form-select form-select-sm"></select></div> <div class="col-12"><select class="form-select form-select-sm"><option>No normalization</option><!></select></div> <div class="col-12"><button type="button" class="btn btn-sm btn-outline-secondary w-100">+ Add metric card</button></div></div> <hr class="dropdown-divider"> <!></div></li> <li class="d-flex flex-wrap gap-1 justify-content-end"><!></li></ul> <!> <!> <!> <div id="conflict-table-1"></div> <!> <hr> <div class="ux-surface p-2"><h4> </h4> <div class="m-0" id="visualization"></div></div> <!></div>');function Sr(K,N){nn(N,!1);const T=S(),w=S(),mt=S(),Bt=S(),Wt=S(),Z=S(),tt=S(),D=S(),et=S(),j=S(),$={COALITION:0,ALLIANCE:1,NATION:2};let gt=S(""),G=S(null),ht=S(!1),rt=S(null),xt=S(""),c=S(null),B=["GROUND_TANKS_MUNITIONS_USED_UNNECESSARY","DOUBLE_FORTIFY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR","AIRSTRIKE_SOLDIERS_NONE","AIRSTRIKE_SOLDIERS_SHOULD_USE_GROUND","AIRSTRIKE_TANKS_NONE","AIRSTRIKE_SHIP_NONE","AIRSTRIKE_INACTIVE_NO_GROUND","AIRSTRIKE_INACTIVE_NO_SHIP","AIRSTRIKE_FAILED_NOT_DOGFIGHT","AIRSTRIKE_AIRCRAFT_NONE","AIRSTRIKE_AIRCRAFT_NONE_INACTIVE","AIRSTRIKE_AIRCRAFT_LOW","AIRSTRIKE_INFRA","AIRSTRIKE_MONEY","NAVAL_MAX_VS_NONE"].map(e=>`off:${e.toLowerCase().replaceAll("_"," ")} attacks`),F={Summary:{sort:"off:wars",columns:["name","net:damage","off:wars","def:wars","dealt:damage","loss:damage"]},Dealt:{sort:"dealt:damage",columns:["name","dealt:infra","dealt:~$soldier","dealt:~$tank","dealt:~$aircraft","dealt:~$ship","dealt:~$unit","dealt:~$consume","dealt:~$loot","dealt:damage"]},Received:{sort:"loss:damage",columns:["name","loss:infra","loss:~$soldier","loss:~$tank","loss:~$aircraft","loss:~$ship","loss:~$unit","loss:~$consume","loss:~$loot","loss:damage"]},Units:{sort:"dealt:~$unit",columns:["name","dealt:soldier","dealt:tank","dealt:aircraft","dealt:ship","dealt:~$unit","loss:soldier","loss:tank","loss:aircraft","loss:ship","loss:~$unit","net:~$unit"]},Consumption:{sort:"name",columns:["name","loss:~$building","loss:gasoline","loss:munitions","loss:steel","loss:aluminum","loss:consume gas","loss:consume mun"]},Attacks:{sort:"off:attacks",columns:["name","off:attacks",...B]}},u=S({layout:$.COALITION,columns:F.Summary.columns,sort:F.Summary.sort,order:"desc"}),C;const V=()=>io(),Nt=[{id:"preset-duration",kind:"preset",key:"duration"},{id:"preset-total-dmg",kind:"preset",key:"damage-total"},{id:"preset-net-gap",kind:"preset",key:"net-gap"}],Y=[{id:"rank-alliance-net",kind:"ranking",entity:"alliance",metric:"net:damage",scope:"all",limit:8},{id:"rank-nation-net",kind:"ranking",entity:"nation",metric:"net:damage",scope:"all",limit:10}],yt={duration:"Duration",wars:"Wars tracked","damage-total":"Total damage exchanged","net-gap":"Damage gap","c1-dealt":"Coalition 1 dealt","c2-dealt":"Coalition 2 dealt",participation:"Participation"},$t={all:"All",coalition1:"Coalition 1",coalition2:"Coalition 2",selection:"Selection snapshot"},Tt=[...Nt,...Y];let I=S([...Tt]),vt=S([]),Gt=S([]),Jt=S([]),ft=S(null),Rt=S(!1),Ie=new Set,xe=new Set,ee=S("No selection"),se=S("nation"),Vt=S("net:damage"),Lt=S("all"),Ne=S(10),ce=S("nation"),Ht=S("net:damage"),Et=S("all"),de=S("sum"),ue=S("");const Ae=()=>`${le()}:kpi-collapsed`;function qt(e){return e==null||isNaN(e)?"N/A":e.toLocaleString()}function Yt(e){return lo(e)}function Pt(){if(!t(G))return;const e=Za(t(G));e.widgets=t(I),so(t(G),e)}function Se(e){if(!e||typeof e!="object")return;let a=[];Array.isArray(e.widgets)?a=e.widgets.map(n=>co(n,Yt)).filter(n=>n!==null):a=uo(e,Yt),a.length>0&&_(I,a)}function dn(){try{if(!t(G))return;const e=Za(t(G));if(Array.isArray(e.widgets)&&e.widgets.length>0){Se({widgets:e.widgets});return}const a=localStorage.getItem(`${le()}:kpi-config`);if(a){const n=JSON.parse(a);Se(n),Pt()}}catch(e){console.warn("Failed to read KPI config",e)}}function fa(e){_(I,t(I).filter(a=>a.id!==e)),Pt()}function _a(e,a){_(I,mo(t(I),e,a)),Pt()}function un(e,a){_(I,vo(t(I),e,a)),Pt()}function mn(e){_(ft,e)}function vn(){_(ft,null)}function fn(e){if(!t(ft)||t(ft)===e){_(ft,null);return}const a=t(I).findIndex(n=>n.id===e);if(a===-1){_(ft,null);return}un(t(ft),a),_(ft,null)}function ke(){const e=Array.from(Ie),a=Array.from(xe),n=[];return e.length>0&&n.push(`${e.length} alliance${e.length===1?"":"s"}`),a.length>0&&n.push(`${a.length} nation${a.length===1?"":"s"}`),{allianceIds:e,nationIds:a,label:n.length>0?n.join(" · "):"No selection"}}function _n(e,a){return e!=="selection"?$t[e]:a!=null&&a.label?`Selection (${a.label})`:$t.selection}function me(e){return e!=="selection"?!0:Ie.size>0||xe.size>0}function pa(e){return t(I).some(a=>a.kind==="preset"&&a.key===e)}function ba(e,a){var m,l,f;const n=new Set,o=new Set;if(e===$.ALLIANCE)for(const b of a){const v=Number((m=b==null?void 0:b[0])==null?void 0:m[1]);Number.isFinite(v)&&n.add(v)}else if(e===$.NATION)for(const b of a){const v=Number((l=b==null?void 0:b[0])==null?void 0:l[1]),p=Number((f=b==null?void 0:b[0])==null?void 0:f[2]);Number.isFinite(v)&&o.add(v),Number.isFinite(p)&&n.add(p)}else if(t(c)&&e===$.COALITION)for(const b of a){const v=Number(b==null?void 0:b[0]);if(!Number.isFinite(v))continue;const p=t(c).coalitions[v];if(p){for(const h of p.alliance_ids)n.add(h);for(const h of p.nation_ids)o.add(h)}}Ie=n,xe=o;const i=ke();_(ee,i.label)}function we(e){_(I,[...t(I),e]),Pt()}function pn(e){pa(e)||we({id:Yt("preset"),kind:"preset",key:e})}function bn(){const e=t(Lt)==="selection"?ke():void 0;t(Lt)==="selection"&&!me(t(Lt))||we({id:Yt("ranking"),kind:"ranking",entity:t(se),metric:t(Vt),scope:t(Lt),limit:Math.max(1,t(Ne)),snapshot:e})}function gn(){const e=t(Et)==="selection"?ke():void 0;t(Et)==="selection"&&!me(t(Et))||we({id:Yt("metric"),kind:"metric",entity:t(ce),metric:t(Ht),scope:t(Et),aggregation:t(de),source:"conflict",normalizeBy:t(ue)||null,snapshot:e})}function hn(){_(Rt,!t(Rt)),localStorage.setItem(Ae(),t(Rt)?"1":"0")}function yn(){t(Rt)&&(_(Rt,!1),localStorage.setItem(Ae(),"0"))}function In(e){const a=e.get("kpi");if(!a)return;const n=a.split(".").map(o=>o.trim()).filter(o=>o in yt);n.length>0&&_(I,n.map(o=>({id:Yt("preset"),kind:"preset",key:o})))}function ga(e){return e==="alliance"?t(D):t(et)}function ha(e){var v,p,h,A;if(!t(c))return[];const a=[...t(c).coalitions[0].alliance_ids,...t(c).coalitions[1].alliance_ids],n=t(c).war_web.headers.indexOf(e.header);if(n<0)return[];const o=t(c).war_web.data[n],i=e.primaryIds.map(x=>a.indexOf(x)).filter(x=>x>=0),m=e.vsIds.map(x=>a.indexOf(x)).filter(x=>x>=0),l=[];let f=0,b=0;for(const x of m){let M=0,L=0;for(const it of i){const at=(p=(v=o[it])==null?void 0:v[x])!=null?p:0,dt=(A=(h=o[x])==null?void 0:h[it])!=null?A:0;M+=Number.isFinite(at)?at:0,L+=Number.isFinite(dt)?dt:0}f+=M,b+=L;const Q=a[x];l.push({label:fe[Q]||te(`AA:${Q}`,Q),allianceId:Q,primary_to_row:M,row_to_primary:L,net:M-L,total:M+L,primary_share_pct:0,row_share_pct:0,abs_net:Math.abs(M-L)})}return l.forEach(x=>{x.primary_share_pct=f>0?x.primary_to_row/f*100:0,x.row_share_pct=b>0?x.row_to_primary/b*100:0}),l}function Oe(e,a){return Number(e==null?void 0:e[a])||0}function ya(e,a,n,o){var m,l,f,b,v,p;if(a==="all")return n.data;if(a==="selection"){const h=new Set((m=o==null?void 0:o.allianceIds)!=null?m:[]),A=new Set((l=o==null?void 0:o.nationIds)!=null?l:[]);return e==="alliance"?h.size===0?[]:n.data.filter(x=>{var L;const M=Number((L=x[0])==null?void 0:L[1]);return h.has(M)}):A.size>0?n.data.filter(x=>{var L;const M=Number((L=x[0])==null?void 0:L[1]);return A.has(M)}):h.size>0?n.data.filter(x=>{var L;const M=Number((L=x[0])==null?void 0:L[2]);return h.has(M)}):[]}if(!t(c))return n.data;const i=a==="coalition1"?new Set((b=(f=t(c).coalitions[0])==null?void 0:f.alliance_ids)!=null?b:[]):new Set((p=(v=t(c).coalitions[1])==null?void 0:v.alliance_ids)!=null?p:[]);return n.data.filter(h=>{var x,M;if(e==="alliance"){const L=Number((x=h[0])==null?void 0:x[1]);return i.has(L)}const A=Number((M=h[0])==null?void 0:M[2]);return i.has(A)})}function xn(e){if(e.source==="aava")return!e.aavaSnapshot||e.entity!=="alliance"?[]:ha(e.aavaSnapshot).map(i=>({label:i.label,alliance:"",value:Oe(i,e.metric)})).sort((i,m)=>m.value-i.value).slice(0,Math.max(1,e.limit));const a=ga(e.entity);if(!a)return[];const n=a.columns.indexOf(e.metric);return n===-1?[]:ya(e.entity,e.scope,a,e.snapshot).map(i=>{var l,f,b,v,p,h;if(e.entity==="alliance")return{label:(f=(l=i[0])==null?void 0:l[0])!=null?f:"N/A",alliance:"",value:Number(i[n])||0};const m=Number((b=i[0])==null?void 0:b[2]);return{label:(p=(v=i[0])==null?void 0:v[0])!=null?p:"N/A",alliance:te((h=fe[m])!=null?h:"",m),value:Number(i[n])||0}}).sort((i,m)=>m.value-i.value).slice(0,Math.max(1,e.limit))}function Nn(e){if(e.source==="aava"){if(!e.aavaSnapshot||e.entity!=="alliance")return null;const l=ha(e.aavaSnapshot),f=l.map(v=>Oe(v,e.metric));if(f.length===0)return null;if(e.normalizeBy){const v=l.map(h=>Oe(h,e.normalizeBy));if(e.aggregation==="sum"){const h=f.reduce((x,M)=>x+M,0),A=v.reduce((x,M)=>x+M,0);return A===0?null:h/A}const p=f.map((h,A)=>{const x=v[A];return x===0?null:h/x}).filter(h=>h!=null);return p.length===0?null:p.reduce((h,A)=>h+A,0)/p.length}const b=f.reduce((v,p)=>v+p,0);return e.aggregation==="avg"?b/f.length:b}const a=ga(e.entity);if(!a)return null;const n=a.columns.indexOf(e.metric);if(n===-1)return null;const o=ya(e.entity,e.scope,a,e.snapshot),i=o.map(l=>Number(l[n])||0);if(i.length===0)return null;if(e.normalizeBy){const l=a.columns.indexOf(e.normalizeBy);if(l===-1)return null;const f=o.map(v=>Number(v[l])||0);if(e.aggregation==="sum"){const v=i.reduce((h,A)=>h+A,0),p=f.reduce((h,A)=>h+A,0);return p===0?null:v/p}const b=i.map((v,p)=>{const h=f[p];return h===0?null:v/h}).filter(v=>v!=null);return b.length===0?null:b.reduce((v,p)=>v+p,0)/b.length}const m=i.reduce((l,f)=>l+f,0);return e.aggregation==="avg"?m/i.length:m}function Kt(e){return cn(e)}function Ia(e){var a,n;if(e.source==="aava"){const o=(n=(a=e.aavaSnapshot)==null?void 0:a.header)!=null?n:"wars";return re(e.metric,o)}return Kt(e.metric)}function xa(e){var a,n;if(!e.normalizeBy)return null;if(e.source==="aava"){const o=(n=(a=e.aavaSnapshot)==null?void 0:a.header)!=null?n:"wars";return re(e.normalizeBy,o)}return Kt(e.normalizeBy)}function ve(e){var a,n;if((e.kind==="ranking"||e.kind==="metric")&&e.source==="aava"){const o=((a=e.aavaSnapshot)==null?void 0:a.label)||"AAvA snapshot",i=((n=e.aavaSnapshot)==null?void 0:n.header)||"wars";return`AAvA (${o} · ${i})`}return e.kind==="preset"?"Preset":_n(e.scope,e.snapshot)}function An(e){if(e.kind==="preset")return yt[e.key];if(e.kind==="ranking")return`${e.entity} · ${Ia(e)} · ${ve(e)} · top ${e.limit}`;const a=xa(e)?` per ${xa(e)}`:"";return`${e.aggregation.toUpperCase()} ${e.entity} · ${Ia(e)}${a} · ${ve(e)}`}function Sn(e,a,n,o,i){_(gt,e.name);const m=Qt(e,a,n,o,i);let l=e.coalitions,f=new Set(l[0].alliance_ids),b=new Set(l[1].alliance_ids);a===$.COALITION?m.row_format=(p,h)=>{let A=h[0];A==0?p.classList.add("bg-danger-subtle"):A==1&&p.classList.add("bg-info-subtle")}:a===$.ALLIANCE?m.row_format=(p,h)=>{let A=h[0][1];f.has(A)?p.classList.add("bg-danger-subtle"):b.has(A)&&p.classList.add("bg-info-subtle")}:a===$.NATION&&(m.row_format=(p,h)=>{let A=h[0][2];f.has(A)?p.classList.add("bg-danger-subtle"):b.has(A)&&p.classList.add("bg-info-subtle")}),m.onSelectionChange=p=>{ba(a,p.selectedRows)},ba(a,[]),C=m;const v=document.getElementById("conflict-table-1");bo(v,C)}function kn(e){let a=e.get("layout");a&&(a==="coalition"?q(u,t(u).layout=$.COALITION):a==="alliance"||a==="1"?q(u,t(u).layout=$.ALLIANCE):(a==="nation"||a==="2")&&q(u,t(u).layout=$.NATION));let n=e.get("sort");n&&q(u,t(u).sort=n);let o=e.get("order");o&&q(u,t(u).order=o);let i=e.get("columns");i&&q(u,t(u).columns=i.split(".")),In(e)}function ae(){t(c)&&Sn(t(c),t(u).layout,t(u).columns,t(u).sort,t(u).order)}function Na(e){_(rt,null),_(ht,!1);let a=`https://locutus.s3.ap-southeast-2.amazonaws.com/conflicts/${e}.gzip?${Ya.version.conflict_data}`;Zn(a).then(n=>{_(c,n),_(xt,to(Ya.version.conflict_data,n.update_ms)),Aa(n.coalitions[0].alliance_ids,n.coalitions[0].alliance_names),Aa(n.coalitions[1].alliance_ids,n.coalitions[1].alliance_names),ae(),n.posts&&Object.keys(n.posts).length&&$n(n.posts),_(ht,!0),oe()}).catch(n=>{console.error("Failed to load conflict data",n),_(rt,"Could not load conflict data. Please try again later."),_(ht,!0)})}let fe={};function Aa(e,a){for(let n=0;n<e.length;(n+=1)-1)fe[e[n]]=te(a[n],e[n])}rn(()=>{Xn(["layout","sort","order","columns","kpi"],["id"]),po(),ne("getIds",(n,o)=>{var i;return(i=t(c))==null?void 0:i.coalitions[o]}),ne("formatNation",n=>{let o=n[2],i=te(fe[o],o);return'<a href="https://politicsandwar.com/alliance/id='+n[2]+'">'+i+'</a> | <a href="https://politicsandwar.com/nation/id='+n[1]+'">'+(n[0]?n[0]:n[1])+"</a>"}),ne("formatAA",n=>{let o=n[1],i=te(n[0],o);return'<a href="https://politicsandwar.com/alliance/id='+o+'">'+i+"</a>"}),ne("formatCol",n=>{let o=n,i=document.createElement("button");return t(c)?(i.setAttribute("type","button"),i.setAttribute("class","ms-1 btn ux-btn btn-sm fw-bold"),i.setAttribute("onclick",`showNames('${t(c).coalitions[o].name}',${o})`),i.textContent=t(c).coalitions[o].name,i.outerHTML):""}),ne("download",function(o,i){eo(document.getElementById("conflict-table-1").querySelector("table"),o,no[i])});let e=new URLSearchParams(window.location.search);kn(e),_(Rt,localStorage.getItem(Ae())==="1");const a=e.get("id");a?(_(G,a),dn(),Na(t(G))):(_(rt,"Missing conflict id in URL"),_(ht,!0))});function wn(e){q(u,t(u).layout=e),ct("layout",t(u).layout),ct("sort",null),ct("columns",null),oe(),ae()}function On(){q(u,t(u).layout=$.COALITION),q(u,t(u).columns=F.Summary.columns),q(u,t(u).sort=F.Summary.sort),q(u,t(u).order="desc"),_(I,[...Tt]),Pt(),ao(["layout","sort","order","columns","kpi"],["id"]),ct("layout",t(u).layout,{replace:!0}),ct("sort",t(u).sort,{replace:!0}),ct("order",t(u).order,{replace:!0}),ct("columns",t(u).columns.join("."),{replace:!0}),ct("kpi",null,{replace:!0}),oe(),ae()}function Cn(){t(G)&&Na(t(G))}let Sa=!1,_e=null;function ka(){const e=document.getElementById("visjs");if(Sa&&_e&&(e&&e.getAttribute("data-loaded")||typeof V()!="undefined")){if(!t(c))return;const a=document.getElementById("visualization");if(!a)return;a.hasChildNodes()&&(a.innerHTML="");const n=V(),o=new n.DataSet;for(const b in _e){const v=_e[b],p=v[0],h=`https://forum.politicsandwar.com/index.php?/topic/${p}-${v[1]}`,A=v[2],x=new Date(A);o.add({id:p,content:`<a href="${h}" target="_blank">${b}</a>`,start:x})}const i=t(c).start;let m=t(c).end;m===-1&&(m=Date.now());const l={start:i,end:m,height:"75vh",width:"100%",zoomKey:"ctrlKey",orientation:"top",verticalScroll:!0},f=new n.Timeline(a,o,l);f.addCustomTime(i,"t1"),f.addCustomTime(m,"t2")}}function $n(e){_e=e,Sa=!0,ka()}function Tn(e){e.target.setAttribute("data-loaded","true"),ka()}ot(()=>t(I),()=>{_(vt,t(I).filter(e=>e.kind==="preset"))}),ot(()=>t(I),()=>{_(Gt,t(I).filter(e=>e.kind==="ranking"))}),ot(()=>t(I),()=>{_(Jt,t(I).filter(e=>e.kind==="metric"))}),ot(()=>(t(c),Ja),()=>{_(T,(()=>{if(!t(c))return"N/A";const e=t(c).start,a=t(c).end===-1?Date.now():t(c).end;return e?Ja(Math.max(0,Math.round((a-e)/1e3))):"N/A"})())}),ot(()=>(t(c),Qt),()=>{_(w,(()=>{if(!t(c))return null;const e=t(c),a=Qt(e,$.COALITION,F.Summary.columns,"name","asc"),n=a.columns.indexOf("dealt:damage"),o=a.columns.indexOf("loss:damage"),i=a.columns.indexOf("net:damage"),m=a.columns.indexOf("off:wars"),l=a.columns.indexOf("def:wars");return n===-1||o===-1||i===-1||m===-1||l===-1?null:a.data.slice(0,2).map((f,b)=>{var v,p;return{idx:b,name:(p=(v=e.coalitions[b])==null?void 0:v.name)!=null?p:`Coalition ${b+1}`,dealt:Number(f[n])||0,received:Number(f[o])||0,net:Number(f[i])||0,wars:(Number(f[m])||0)+(Number(f[l])||0)}})})())}),ot(()=>t(w),()=>{_(mt,t(w)?t(w).reduce((e,a)=>e+a.dealt,0):null)}),ot(()=>t(w),()=>{_(Bt,t(w)?Math.max(...t(w).map(e=>e.wars)):null)}),ot(()=>t(w),()=>{_(Wt,t(w)?Math.max(...t(w).map(e=>Math.abs(e.net))):null)}),ot(()=>(t(c),Qt),()=>{_(Z,(()=>{if(!t(c))return null;const e=Qt(t(c),$.NATION,F.Summary.columns,"name","asc"),a=e.columns.indexOf("off:wars"),n=e.columns.indexOf("def:wars");if(a===-1||n===-1)return null;const o=e.data.length;if(o===0)return null;const i=e.data.filter(m=>{const l=Number(m[a])||0,f=Number(m[n])||0;return l+f>0}).length;return{active:i,total:o,pct:i/o*100}})())}),ot(()=>t(w),()=>{_(tt,t(w)?t(w).reduce((e,a)=>a.net>e.net?a:e,t(w)[0]):null)}),ot(()=>(t(c),t(u)),()=>{_(D,t(c)?Qt(t(c),$.ALLIANCE,t(u).columns,t(u).sort,t(u).order):null)}),ot(()=>(t(c),t(u)),()=>{_(et,t(c)?Qt(t(c),$.NATION,t(u).columns,t(u).sort,t(u).order):null)}),ot(()=>t(et),()=>{_(j,t(et)?t(et).columns.filter((e,a)=>{var i,m,l,f;if(a===0)return!1;const n=(m=(i=t(et).cell_format)==null?void 0:i.formatMoney)!=null?m:[],o=(f=(l=t(et).cell_format)==null?void 0:l.formatNumber)!=null?f:[];return n.includes(a)||o.includes(a)}):[])}),ot(()=>(t(j),t(Vt),t(Ht)),()=>{t(j).length>0&&(t(j).includes(t(Vt))||_(Vt,t(j)[0]),t(j).includes(t(Ht))||_(Ht,t(j)[0]))}),Yn(),an();var Ce=cr();Vn(e=>{var a=To(),n=z(a),o=d(n);g(()=>{var i;return Qn.title=`Conflict ${(i=t(gt))!=null?i:""}`}),U("load",n,Tn),y(e,a)});var $e=s(Ce),wa=d(s($e)),Rn=d(wa);E(Rn,()=>{var e;return(e=t(c))==null?void 0:e.wiki},e=>{var a=Ro(),n=s(a);ma(),r(a),g(()=>{var o,i,m;Qa(a,"href",`https://politicsandwar.fandom.com/wiki/${(o=t(c).wiki)!=null?o:""}`),O(n,`Wiki:${(m=(i=t(c))==null?void 0:i.wiki)!=null?m:""} `)}),y(e,a)}),r($e);var Oa=d($e,2);_o(Oa,{get conflictId(){return t(G)},mode:"layout-picker",get currentLayout(){return t(u).layout},active:"coalition",onLayoutSelect:wn});var Te=d(Oa,2),Ca=d(s(Te),2);Ot(Ca,1,()=>Object.keys(F),Ct,(e,a)=>{var n=Lo(),o=s(n),i=s(o,!0);r(o),r(n),g(()=>{var m;qa(o,`btn ux-btn btn-sm ms-1 fw-bold ${(m=t(u).columns===F[t(a)].columns?"active":"")!=null?m:""}`),O(i,t(a))}),U("click",o,()=>{q(u,t(u).columns=F[t(a)].columns),q(u,t(u).sort=F[t(a)].sort),ct("sort",t(u).sort),ct("columns",t(u).columns.join(".")),oe(),ae()}),y(e,n)});var Re=d(Ca,2),Ln=s(Re),En=X(()=>t(vt).map(e=>e.key)),Pn=X(()=>({widgets:t(I),presetCards:t(vt),rankingCards:t(Gt),metricCards:t(Jt)}));$o(Ln,{get currentColumns(){return t(u).columns},get currentSort(){return t(u).sort},get currentOrder(){return t(u).order},get currentKpis(){return t(En)},get currentKpiConfig(){return t(Pn)},$$events:{load:e=>{const a=e.detail.preset;if(q(u,t(u).columns=a.columns),a.sort&&q(u,t(u).sort=a.sort),a.order&&q(u,t(u).order=a.order),a.kpiConfig)Se(a.kpiConfig),Pt();else if(Array.isArray(a.kpis)&&a.kpis.length>0){const n=a.kpis.filter(o=>o in yt).map(o=>o);n.length>0&&(_(I,n.map(o=>({id:Yt("preset"),kind:"preset",key:o}))),Pt())}ct("columns",t(u).columns.join(".")),ct("sort",t(u).sort),ct("order",t(u).order),oe(),ae()}}}),r(Re);var $a=d(Re,2);E($a,()=>t(Rt),e=>{var a=Eo(),n=s(a);r(a),U("click",n,yn),y(e,a)});var Le=d($a,2),Ta=d(s(Le),2),Ra=d(s(Ta),2);E(Ra,()=>t(I).length===0,e=>{var a=Po();y(e,a)});var La=d(Ra,2);Ot(La,1,()=>t(I),Ct,(e,a,n)=>{var o=Ko(),i=s(o),m=s(i,!0);g(()=>O(m,An(t(a)))),r(i);var l=d(i,2),f=s(l);f.disabled=n===0;var b=d(f,2),v=d(b,2);r(l),r(o),g(()=>b.disabled=n===t(I).length-1),U("click",f,jt(Zt(()=>_a(t(a).id,-1)))),U("click",b,jt(Zt(()=>_a(t(a).id,1)))),U("click",v,jt(Zt(()=>fa(t(a).id)))),y(e,o)});var Ee=d(La,6);Ot(Ee,5,()=>Object.keys(yt),Ct,(e,a)=>{var n=Do();const o=X(()=>t(a));g(()=>n.disabled=pa(t(o)));var i=s(n);r(n),g(()=>{var m;return O(i,`+ ${(m=yt[t(o)])!=null?m:""}`)}),U("click",n,jt(Zt(()=>pn(t(o))))),y(e,n)}),r(Ee);var Pe=d(Ee,6),Ke=s(Pe),De=s(Ke);g(()=>{t(se),zt(()=>{})});var Me=s(De);Me.value=(Me.__value="alliance")==null?"":"alliance";var Ea=d(Me);Ea.value=(Ea.__value="nation")==null?"":"nation",r(De),r(Ke);var Fe=d(Ke,2),ze=s(Fe);g(()=>{t(Lt),zt(()=>{t(ee)})});var Ue=s(ze);Ue.value=(Ue.__value="all")==null?"":"all";var je=d(Ue);je.value=(je.__value="coalition1")==null?"":"coalition1";var Be=d(je);Be.value=(Be.__value="coalition2")==null?"":"coalition2";var pe=d(Be);pe.value=(pe.__value="selection")==null?"":"selection";var Kn=s(pe);r(pe),r(ze),r(Fe);var We=d(Fe,2),Pa=s(We);ln(Pa),r(We);var Ge=d(We,2),Ve=s(Ge);g(()=>{t(Vt),zt(()=>{t(j)})}),Ot(Ve,5,()=>t(j),Ct,(e,a)=>{var n=Mo(),o={},i=s(n,!0);g(()=>O(i,Kt(t(a)))),r(n),g(()=>{o!==(o=t(a))&&(n.value=(n.__value=t(a))==null?"":t(a))}),y(e,n)}),r(Ve),r(Ge);var Ka=d(Ge,2),Da=s(Ka);g(()=>Da.disabled=!me(t(Lt))),r(Ka),r(Pe);var He=d(Pe,6),Ye=s(He),Qe=s(Ye);g(()=>{t(ce),zt(()=>{})});var Je=s(Qe);Je.value=(Je.__value="alliance")==null?"":"alliance";var Ma=d(Je);Ma.value=(Ma.__value="nation")==null?"":"nation",r(Qe),r(Ye);var qe=d(Ye,2),Xe=s(qe);g(()=>{t(Et),zt(()=>{t(ee)})});var Ze=s(Xe);Ze.value=(Ze.__value="all")==null?"":"all";var ta=d(Ze);ta.value=(ta.__value="coalition1")==null?"":"coalition1";var ea=d(ta);ea.value=(ea.__value="coalition2")==null?"":"coalition2";var be=d(ea);be.value=(be.__value="selection")==null?"":"selection";var Dn=s(be);r(be),r(Xe),r(qe);var aa=d(qe,2),na=s(aa);g(()=>{t(de),zt(()=>{})});var oa=s(na);oa.value=(oa.__value="sum")==null?"":"sum";var Fa=d(oa);Fa.value=(Fa.__value="avg")==null?"":"avg",r(na),r(aa);var ra=d(aa,2),ia=s(ra);g(()=>{t(Ht),zt(()=>{t(j)})}),Ot(ia,5,()=>t(j),Ct,(e,a)=>{var n=Fo(),o={},i=s(n,!0);g(()=>O(i,Kt(t(a)))),r(n),g(()=>{o!==(o=t(a))&&(n.value=(n.__value=t(a))==null?"":t(a))}),y(e,n)}),r(ia),r(ra);var la=d(ra,2),sa=s(la);g(()=>{t(ue),zt(()=>{t(j)})});var ca=s(sa);ca.value=((ca.__value="")==null,"");var Mn=d(ca);Ot(Mn,1,()=>t(j),Ct,(e,a)=>{var n=zo(),o={},i=s(n);g(()=>{var m;return O(i,`Per ${(m=Kt(t(a)))!=null?m:""}`)}),r(n),g(()=>{o!==(o=t(a))&&(n.value=(n.__value=t(a))==null?"":t(a))}),y(e,n)}),r(sa),r(la);var za=d(la,2),Ua=s(za);g(()=>Ua.disabled=!me(t(Et))),r(za),r(He);var Fn=d(He,4);E(Fn,()=>t(G),e=>{var a=Uo();g(()=>Qa(a,"href",`aava?id=${t(G)}`)),y(e,a)}),r(Ta),r(Le);var ja=d(Le,2),zn=s(ja);qn(zn,{onReset:On}),r(ja),r(Te);var Ba=d(Te,2);E(Ba,()=>t(c)&&!t(Rt),e=>{var a=nr(),n=s(a),o=d(s(n),2);r(n);var i=d(n,2);Ot(i,5,()=>t(I),Ct,(m,l)=>{var f=ar();const b=X(()=>t(l).kind==="ranking");var v=s(f),p=s(v),h=d(p,2);E(h,()=>t(l).kind==="preset",A=>{var x=Ft(),M=z(x);E(M,()=>t(l).key==="duration",L=>{var Q=jo(),it=d(z(Q),2),at=s(it,!0);r(it),g(()=>O(at,t(T))),y(L,Q)},L=>{var Q=Ft(),it=z(Q);E(it,()=>t(l).key==="wars",at=>{var dt=Bo(),Dt=d(z(dt),2),At=s(Dt,!0);g(()=>O(At,qt(t(Bt)))),r(Dt),y(at,dt)},at=>{var dt=Ft(),Dt=z(dt);E(Dt,()=>t(l).key==="damage-total",At=>{var St=Wo(),Mt=d(z(St),2),_t=s(Mt,!0);g(()=>O(_t,qt(t(mt)))),r(Mt),y(At,St)},At=>{var St=Ft(),Mt=z(St);E(Mt,()=>t(l).key==="net-gap",_t=>{var It=Vo(),P=d(z(It),2),nt=s(P,!0);g(()=>O(nt,qt(t(Wt)))),r(P);var H=d(P,2);E(H,()=>t(tt),kt=>{var pt=Go(),lt=s(pt);r(pt),g(()=>{var R;return O(lt,`Lead: ${(R=t(tt).name)!=null?R:""}`)}),y(kt,pt)}),y(_t,It)},_t=>{var It=Ft(),P=z(It);E(P,()=>t(l).key==="c1-dealt",nt=>{var H=Ho(),kt=z(H),pt=s(kt);r(kt);var lt=d(kt,2),R=s(lt,!0);g(()=>{var W,J;return O(R,qt((J=(W=t(w))==null?void 0:W[0])==null?void 0:J.dealt))}),r(lt),g(()=>{var W,J,ut,st;return O(pt,`${(st=(ut=(J=(W=t(w))==null?void 0:W[0])==null?void 0:J.name)!=null?ut:"Coalition 1")!=null?st:""} dealt`)}),y(nt,H)},nt=>{var H=Ft(),kt=z(H);E(kt,()=>t(l).key==="c2-dealt",pt=>{var lt=Yo(),R=z(lt),W=s(R);r(R);var J=d(R,2),ut=s(J,!0);g(()=>{var st,bt;return O(ut,qt((bt=(st=t(w))==null?void 0:st[1])==null?void 0:bt.dealt))}),r(J),g(()=>{var st,bt,Xt,wt;return O(W,`${(wt=(Xt=(bt=(st=t(w))==null?void 0:st[1])==null?void 0:bt.name)!=null?Xt:"Coalition 2")!=null?wt:""} dealt`)}),y(pt,lt)},pt=>{var lt=Ft(),R=z(lt);E(R,()=>t(l).key==="participation",W=>{var J=Jo(),ut=d(z(J),2),st=s(ut,!0);g(()=>O(st,t(Z)?`${t(Z).pct.toFixed(1)}%`:"N/A")),r(ut);var bt=d(ut,2);E(bt,()=>t(Z),Xt=>{var wt=Qo(),ge=s(wt);r(wt),g(()=>{var he,ye;return O(ge,`${(he=t(Z).active)!=null?he:""}/${(ye=t(Z).total)!=null?ye:""}
                                            nations with at least one war`)}),y(Xt,wt)}),y(W,J)},null,!0),y(pt,lt)},!0),y(nt,H)},!0),y(_t,It)},!0),y(At,St)},!0),y(at,dt)},!0),y(L,Q)}),y(A,x)},A=>{var x=Ft(),M=z(x);E(M,()=>t(l).kind==="ranking",L=>{var Q=tr();const it=X(()=>xn(t(l)));var at=z(Q);const dt=X(()=>{var R;return(R=t(l).limit)!=null?R:""}),Dt=X(()=>{var R;return(R=t(l).entity)!=null?R:""}),At=X(()=>{var R,W,J;return(J=t(l).source==="aava"?re(t(l).metric,(W=(R=t(l).aavaSnapshot)==null?void 0:R.header)!=null?W:"wars"):Kt(t(l).metric))!=null?J:""}),St=X(()=>{var R;return(R=ve(t(l)))!=null?R:""});var Mt=s(at);g(()=>O(Mt,`Top ${t(dt)}
                                    ${t(Dt)}s by
                                    ${t(At)}
                                    (${t(St)})`)),r(at);var _t=d(at,2),It=s(_t),P=s(It),nt=s(P),H=d(s(nt)),kt=s(H,!0);r(H);var pt=d(H);E(pt,()=>t(l).entity==="nation",R=>{var W=qo();y(R,W)}),ma(),r(nt),r(P);var lt=d(P);Ot(lt,5,()=>t(it),Ct,(R,W,J)=>{var ut=Zo(),st=s(ut);st.textContent=J+1;var bt=d(st),Xt=s(bt,!0);r(bt);var wt=d(bt);E(wt,()=>t(l).entity==="nation",ye=>{var ua=Xo(),Gn=s(ua,!0);r(ua),g(()=>O(Gn,t(W).alliance)),y(ye,ua)});var ge=d(wt),he=s(ge,!0);g(()=>O(he,t(W).value.toLocaleString())),r(ge),r(ut),g(()=>O(Xt,t(W).label)),y(R,ut)}),r(lt),r(It),r(_t),g(()=>O(kt,t(l).entity==="alliance"?"Alliance":"Nation")),y(L,Q)},L=>{var Q=er(),it=z(Q);const at=X(()=>{var P;return(P=t(l).aggregation.toUpperCase())!=null?P:""}),dt=X(()=>{var P;return(P=t(l).entity)!=null?P:""}),Dt=X(()=>{var P,nt,H;return(H=t(l).source==="aava"?re(t(l).metric,(nt=(P=t(l).aavaSnapshot)==null?void 0:P.header)!=null?nt:"wars"):Kt(t(l).metric))!=null?H:""}),At=X(()=>{var P,nt,H;return(H=t(l).normalizeBy?` per ${t(l).source==="aava"?re(t(l).normalizeBy,(nt=(P=t(l).aavaSnapshot)==null?void 0:P.header)!=null?nt:"wars"):Kt(t(l).normalizeBy)}`:"")!=null?H:""}),St=X(()=>{var P;return(P=ve(t(l)))!=null?P:""});var Mt=s(it);g(()=>O(Mt,`${t(at)}
                                    ${t(dt)}
                                    ${t(Dt)}
                                    ${t(At)}
                                    (${t(St)})`)),r(it);var _t=d(it,2),It=s(_t,!0);g(()=>O(It,qt(Nn(t(l))))),r(_t),y(L,Q)},!0),y(A,x)}),r(v),r(f),g(()=>{qa(f,t(b)?"col-12 col-lg-6":"col-12 col-sm-6 col-xl-4"),oo(v,"kpi-card-dragging",t(ft)===t(l).id)}),U("click",p,()=>fa(t(l).id)),U("dragstart",v,()=>mn(t(l).id)),U("dragend",v,vn),U("dragover",v,jt(function(A){fo.call(this,N,A)})),U("drop",v,jt(()=>fn(t(l).id))),y(m,f)}),r(i),r(a),U("click",o,hn),y(e,a)});var Wa=d(Ba,2);E(Wa,()=>!t(ht),e=>{ro(e)});var Ga=d(Wa,2);E(Ga,()=>t(rt),e=>{var a=or(),n=s(a),o=s(n,!0);r(n);var i=d(n,2);r(a),g(()=>O(o,t(rt))),U("click",i,Cn),y(e,a)});var Va=d(Ga,4);E(Va,()=>t(u).layout==$.COALITION,e=>{var a=lr(),n=d(z(a),2),o=s(n);E(o,()=>{var m;return(m=t(c))==null?void 0:m.cb},m=>{var l=rr(),f=s(l),b=d(s(f),2),v=s(b,!0);r(b),r(f),r(l),g(()=>{var p;return O(v,(p=t(c))==null?void 0:p.cb)}),y(m,l)});var i=d(o,2);E(i,()=>{var m;return(m=t(c))==null?void 0:m.status},m=>{var l=ir(),f=s(l),b=d(s(f),2),v=s(b,!0);r(b),r(f),r(l),g(()=>{var p;return O(v,(p=t(c))==null?void 0:p.status)}),y(m,l)}),r(n),y(e,a)});var da=d(Va,4),Ha=s(da);const Un=X(()=>{var e,a,n;return(n=Xa((a=(e=t(c))==null?void 0:e.start)!=null?a:null))!=null?n:""}),jn=X(()=>{var e,a,n;return(n=Xa((a=(e=t(c))==null?void 0:e.end)!=null?a:null))!=null?n:""});var Bn=s(Ha);g(()=>O(Bn,`${t(Un)} - ${t(jn)}`)),r(Ha),ma(2),r(da);var Wn=d(da,2);E(Wn,()=>t(xt),e=>{var a=sr(),n=s(a,!0);r(a),g(()=>O(n,t(xt))),y(e,a)}),r(Ce),g(()=>{var e,a,n;O(wa,` Conflict: ${(e=t(gt))!=null?e:""} `),O(Kn,`Selection snapshot (${(a=t(ee))!=null?a:""})`),O(Dn,`Selection snapshot (${(n=t(ee))!=null?n:""})`)}),Ut(De,()=>t(se),e=>_(se,e)),Ut(ze,()=>t(Lt),e=>_(Lt,e)),sn(Pa,()=>t(Ne),e=>_(Ne,e)),Ut(Ve,()=>t(Vt),e=>_(Vt,e)),U("click",Da,jt(Zt(bn))),Ut(Qe,()=>t(ce),e=>_(ce,e)),Ut(Xe,()=>t(Et),e=>_(Et,e)),Ut(na,()=>t(de),e=>_(de,e)),Ut(ia,()=>t(Ht),e=>_(Ht,e)),Ut(sa,()=>t(ue),e=>_(ue,e)),U("click",Ua,jt(Zt(gn))),y(K,Ce),on()}export{Sr as component};
