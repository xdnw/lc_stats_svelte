var wo=Object.defineProperty,To=Object.defineProperties;var Lo=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var _n=Object.prototype.hasOwnProperty,bn=Object.prototype.propertyIsEnumerable;var pn=(I,_,y)=>_ in I?wo(I,_,{enumerable:!0,configurable:!0,writable:!0,value:y}):I[_]=y,ga=(I,_)=>{for(var y in _||(_={}))_n.call(_,y)&&pn(I,y,_[y]);if(be)for(var y of be(_))bn.call(_,y)&&pn(I,y,_[y]);return I},ha=(I,_)=>To(I,Lo(_));var gn=(I,_)=>{var y={};for(var R in I)_n.call(I,R)&&_.indexOf(R)<0&&(y[R]=I[R]);if(I!=null&&be)for(var R of be(I))_.indexOf(R)<0&&bn.call(I,R)&&(y[R]=I[R]);return y};var hn=(I,_,y)=>new Promise((R,et)=>{var yt=B=>{try{lt(y.next(B))}catch(D){et(D)}},K=B=>{try{lt(y.throw(B))}catch(D){et(D)}},lt=B=>B.done?R(B.value):Promise.resolve(B.value).then(yt,K);lt((y=y.apply(I,_)).next())});import{e as q,a as k,f as C,s as w,w as Ro,c as Eo}from"../chunks/DLCQTpuP.js";import{i as kn}from"../chunks/DT10vATe.js";import{c as Ko,o as Cn}from"../chunks/Di_BE8QR.js";import{p as On,g as t,b as wn,s as d,c,e as p,m as A,r,u,E as Do,t as E,l as tt,a as Po,i as ht,d as Mo,j as Qt,h as ee,k as rt,$ as Fo,n as ya}from"../chunks/DVbRBn6a.js";import{i as J}from"../chunks/Bxs4rezJ.js";import{f as ye,e as Tt,i as Lt,h as zo,j as ge,s as ae,r as Wo,a as jo,g as Uo,k as $o,d as yn}from"../chunks/BLlCKcKh.js";import{r as Tn,b as Ft,c as Ia,s as re,a as Na,f as Bo}from"../chunks/DnCfu7FQ.js";import{b as Ln}from"../chunks/BsffpG_N.js";import{p as zt,s as ne}from"../chunks/Bfc47y5P.js";import{b as Vo}from"../chunks/Bj3kfB5S.js";import{C as Go}from"../chunks/Ce5oxAg0.js";import{w as xa,b as oe,B as Qo,S as Ho,x as In,s as le,d as Yo,t as he,f as Jo,y as qo,p as Xo,a as Zo,E as ti,P as ei}from"../chunks/DqDmrPFw.js";import{b as Sa}from"../chunks/DjEpIcmV.js";import{s as ai,a as ni}from"../chunks/BI-WfodV.js";import{t as Rn}from"../chunks/C-5gSOKl.js";import{a as oi,r as Nn,s as ii,m as si,p as ri,c as li,d as Wt,e as ci,b as Sn,f as di}from"../chunks/CGgAoYQ3.js";import{p as ce}from"../chunks/DF-onhJ0.js";function Ht(I,_,y,R,et){let yt=I.coalitions,K=I.damage_header,lt=I.header_type,B=[],D=[],at=[],kt=[],ct={},nt=null;switch(_){case 0:nt=null;break;case 1:nt=null;break;case 2:nt=null;break}D.push("name");for(let N=0;N<K.length;N++){let Q=Rn(K[N]),mt=lt[N];mt==0?(D.push("loss:".concat(Q)),D.push("dealt:".concat(Q.replace("_loss","").replace("loss_",""))),D.push("net:".concat(Q.replace("_loss","").replace("loss_","")))):mt==1&&(D.push("def:".concat(Q)),D.push("off:".concat(Q)),D.push("both:".concat(Q)))}at.push(0),_===0?ct.formatCol=[0]:_===1?ct.formatAA=[0]:_===2&&(ct.formatNation=[0]);let jt=[Math.max(0,D.indexOf(R)),et];const P=new Set(y);ct.formatNumber=[],ct.formatMoney=[];for(let N=0;N<D.length;N++)P.has(D[N])&&kt.push(N),N>0&&(D[N].includes("~")||D[N].includes("damage")||D[N].includes("infra")&&!D[N].includes("attacks")?ct.formatMoney.push(N):ct.formatNumber.push(N));let _t=(N,Q,mt)=>{for(let m=0;m<Q.length;m++){let Nt=Q[m],S=mt[m],l=lt[m],Z;l==0?Z=S-Nt:Z=S+Nt,N.push(Nt),N.push(S),N.push(Z)}},X=(N,Q)=>{let mt=N.alliance_ids,m=N.alliance_names,Nt=N.nation_ids,S=N.nation_names,l=N.nation_aa,Z=N.damage;switch(_){case 0:let Ct=[Q];_t(Ct,Z[0],Z[1]),B.push(Ct);break;case 1:let Yt=2;for(let H=0;H<mt.length;H++){let bt=[],St=mt[H],T=oe(m[H],St);bt.push([T,St]),_t(bt,Z[H*2+Yt],Z[H*2+Yt+1]),B.push(bt)}break;case 2:let Ut=2+mt.length*2;for(let H=0;H<Nt.length;H++){let bt=[],St=Nt[H],T=xa(S[H],St),Jt=l[H];bt.push([T,St,Jt]),_t(bt,Z[H*2+Ut],Z[H*2+Ut+1]),B.push(bt)}break}};for(let N=0;N<yt.length;N++){let Q=yt[N];X(Q,N)}return{columns:D,data:B,visible:kt,searchable:at,cell_format:ct,row_format:nt,sort:jt}}var ui=Object.defineProperty,mi=Object.defineProperties,vi=Object.getOwnPropertyDescriptors,xn=Object.getOwnPropertySymbols,fi=Object.prototype.hasOwnProperty,pi=Object.prototype.propertyIsEnumerable,An=(I,_,y)=>_ in I?ui(I,_,{enumerable:!0,configurable:!0,writable:!0,value:y}):I[_]=y,_i=(I,_)=>{for(var y in _||(_={}))fi.call(_,y)&&An(I,y,_[y]);if(xn)for(var y of xn(_))pi.call(_,y)&&An(I,y,_[y]);return I},bi=(I,_)=>mi(I,vi(_));function Aa(I){const _="".concat(ye(),":presets");try{const y=localStorage.getItem(_);if(!y)return{};const R=JSON.parse(y);return!R||typeof R!="object"?{}:R}catch(y){return console.warn("Failed to read column presets",y),{}}}function gi(I,_,y){const R="".concat(ye(),":presets");try{const et=Aa(y);et[I]=bi(_i({},_),{createdAt:Date.now()}),localStorage.setItem(R,JSON.stringify(et))}catch(et){console.warn("Failed to save column preset",et)}}function hi(I,_){const y="".concat(ye(),":presets");try{const R=Aa(_);Object.prototype.hasOwnProperty.call(R,I)&&(delete R[I],localStorage.setItem(y,JSON.stringify(R)))}catch(R){console.warn("Failed to delete column preset",R)}}var yi=C('<div class="small text-muted px-2">No saved layouts</div>'),Ii=C('<div class="preset-item px-2 py-1 small svelte-ukze6s"><div class="text-truncate" style="max-width:140px"> </div> <div><button class="btn ux-btn btn-sm me-1">Load</button> <button class="btn btn-sm btn-outline-danger">Delete</button></div></div>'),Ni=C('<div class="dropdown d-inline"><button class="btn ux-btn btn-sm" type="button" id="cpDropdown" data-bs-toggle="dropdown" aria-expanded="false">My layouts&nbsp;<i class="bi bi-chevron-down"></i></button> <div class="dropdown-menu p-2" aria-labelledby="cpDropdown" style="min-width:260px;"><div class="input-group input-group-sm mb-2"><input class="form-control form-control-sm" placeholder="Save current as..."/> <button class="btn ux-btn btn-sm">Save</button></div> <hr class="dropdown-divider"/> <div class="preset-list svelte-ukze6s"><!> <!></div></div></div>');function Si(I,_){On(_,!1);let y=ce(_,"currentColumns",24,()=>[]),R=ce(_,"currentSort",8,""),et=ce(_,"currentOrder",8,"desc"),yt=ce(_,"currentKpis",24,()=>[]),K=ce(_,"currentKpiConfig",8,null);const lt=Ko();let B=A({}),D=A("");function at(){p(B,Aa())}Cn(at);function kt(){const S=(t(D)||"").trim();if(!S){lt("error",{message:"Name required"});return}t(B)[S]&&!confirm(`Overwrite layout "${S}"?`)||(gi(S,{columns:y(),sort:R(),order:et(),kpis:yt(),kpiConfig:K()}),p(D,""),at(),lt("saved",{name:S}))}function ct(S){const l=t(B)[S];l&&lt("load",{name:S,preset:l})}function nt(S){confirm(`Delete layout "${S}"?`)&&(hi(S),at(),lt("deleted",{name:S}))}kn();var dt=Ni(),jt=d(c(dt),2),P=c(jt),_t=c(P);Tn(_t);var X=d(_t,2);r(P);var N=d(P,4),Q=c(N);{var mt=S=>{var l=yi();k(S,l)},m=Do(()=>(t(B),u(()=>Object.keys(t(B)).length===0)));J(Q,S=>{t(m)&&S(mt)})}var Nt=d(Q,2);Tt(Nt,1,()=>(t(B),u(()=>Object.keys(t(B)))),Lt,(S,l)=>{var Z=Ii(),Ct=c(Z),Yt=c(Ct,!0);r(Ct);var Ut=d(Ct,2),H=c(Ut),bt=d(H,2);r(Ut),r(Z),E(()=>w(Yt,t(l))),q("click",H,()=>ct(t(l))),q("click",bt,()=>nt(t(l))),k(S,Z)}),r(N),r(jt),r(dt),Ln(_t,()=>t(D),S=>p(D,S)),q("click",X,kt),k(I,dt),wn()}var xi=Ro(C('<script id="visjs" async="" src="https://cdnjs.cloudflare.com/ajax/libs/vis-timeline/7.7.3/vis-timeline-graph2d.min.js"><\/script><!>',1)),Ai=C('<a class="btn ux-btn fw-bold"> <i class="bi bi-box-arrow-up-right"></i></a>'),ki=C("<li><button> </button></li>"),Ci=C('<li><button class="btn ux-btn btn-sm">Show KPI</button></li>'),Oi=C('<div class="small text-muted mb-2">No cards</div>'),wi=C('<div class="d-flex align-items-center justify-content-between gap-2 mb-1"><span class="small text-truncate"> </span> <div class="d-flex gap-1"><button type="button" class="btn btn-sm btn-outline-secondary">↑</button> <button type="button" class="btn btn-sm btn-outline-secondary">↓</button> <button type="button" class="btn btn-sm btn-outline-danger">Remove</button></div></div>'),Ti=C('<button type="button" class="btn btn-sm btn-outline-secondary"> </button>'),Li=C("<option> </option>"),Ri=C("<option> </option>"),Ei=C("<option> </option>"),Ki=C('<a class="btn btn-sm btn-outline-secondary w-100 mt-1">Add AAvA widgets from the AAvA page</a>'),Di=C('<div class="small text-muted">Duration</div> <div class="h6 m-0"> </div>',1),Pi=C('<div class="small text-muted">Wars tracked</div> <div class="h6 m-0"> </div>',1),Mi=C('<div class="small text-muted">Total damage exchanged</div> <div class="h6 m-0"> </div>',1),Fi=C('<div class="small text-muted"> </div>'),zi=C('<div class="small text-muted">Damage gap</div> <div class="h6 m-0"> </div> <!>',1),Wi=C('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),ji=C('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),Ui=C('<div class="small text-muted"> </div>'),$i=C('<div class="small text-muted">Offensive wars per nation</div> <div class="h6 m-0"> </div> <!>',1),Bi=C("<th>Alliance</th>"),Vi=C("<a> </a>"),Gi=C("<a> </a>"),Qi=C("<td><a> </a></td>"),Hi=C('<tr><td></td><td><!></td><!><td class="text-end"> </td></tr>'),Yi=C('<div class="small text-muted mb-1"> </div> <div class="table-responsive"><table class="table table-sm table-striped m-0"><thead><tr><th>#</th><th> </th><!><th class="text-end">Value</th></tr></thead><tbody></tbody></table></div>',1),Ji=C('<div class="small text-muted"> </div> <div class="h6 m-0"> </div>',1),qi=C('<div><div role="group" draggable="true"><button type="button" class="btn-close kpi-card-close" aria-label="Remove KPI card"></button> <!></div></div>'),Xi=C('<div class="ux-surface p-2 mb-3 rounded border"><div class="d-flex align-items-center justify-content-between mb-2"><h5 class="m-0">KPI</h5> <button type="button" class="btn-close" aria-label="Hide KPI"></button></div> <div class="row g-2"></div></div>'),Zi=C('<div class="alert alert-danger m-2 d-flex justify-content-between align-items-center"><span> </span> <button class="btn btn-sm btn-outline-danger fw-bold">Retry</button></div>'),ts=C('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Casus Belli</h3> <pre> </pre></div></div>'),es=C('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Status</h3> <pre> </pre></div></div>'),as=C('<hr/> <div class="row m-0"><!> <!></div>',1),ns=C('<div class="small text-muted text-end mt-2"> </div>'),os=C('<div class="container-fluid p-2 ux-page-body"><h1 class="m-0 mb-2 p-2 ux-surface ux-page-title"><div class="ux-page-title-stack"><!> <span class="ux-page-title-main"> </span></div> <!></h1> <!> <ul class="layout-picker-bar ux-floating-controls nav fw-bold nav-pills m-0 p-2 ux-surface mb-3 d-flex flex-wrap gap-1"><li class="me-1">Layout Picker:</li> <!> <li><!></li> <!> <li class="dropdown ms-auto" data-bs-auto-close="outside"><button class="btn ux-btn btn-sm" type="button" id="kpiManagerDropdown" data-bs-toggle="dropdown" aria-expanded="false">KPI widgets&nbsp;<i class="bi bi-chevron-down"></i></button> <div class="dropdown-menu p-2" aria-labelledby="kpiManagerDropdown" style="min-width: 340px;"><div class="small text-muted mb-1">KPI cards</div> <!> <!> <hr class="dropdown-divider"/> <div class="small text-muted mb-1">Preset cards</div> <div class="d-flex flex-wrap gap-1 mb-2"></div> <hr class="dropdown-divider"/> <div class="small text-muted mb-1">Ranking cards</div> <div class="row g-1 mb-2"><div class="col-4"><select class="form-select form-select-sm"><option>Alliance</option><option>Nation</option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>All</option><option>Coalition 1</option><option>Coalition 2</option><option> </option></select></div> <div class="col-4"><input class="form-control form-control-sm" type="number" min="1"/></div> <div class="col-12"><select class="form-select form-select-sm"></select></div> <div class="col-12"><button type="button" class="btn btn-sm btn-outline-secondary w-100">+ Add ranking card</button></div></div> <hr class="dropdown-divider"/> <div class="small text-muted mb-1">Metric cards</div> <div class="row g-1"><div class="col-4"><select class="form-select form-select-sm"><option>Alliance</option><option>Nation</option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>All</option><option>Coalition 1</option><option>Coalition 2</option><option> </option></select></div> <div class="col-4"><select class="form-select form-select-sm"><option>Sum</option><option>Avg</option></select></div> <div class="col-12"><select class="form-select form-select-sm"></select></div> <div class="col-12"><select class="form-select form-select-sm"><option>No normalization</option><!></select></div> <div class="col-12"><button type="button" class="btn btn-sm btn-outline-secondary w-100">+ Add metric card</button></div></div> <hr class="dropdown-divider"/> <!></div></li> <li class="d-flex flex-wrap gap-1 justify-content-end"><!></li></ul> <!> <!> <!> <div id="conflict-table-1"></div> <!> <hr/> <div class="ux-surface p-2"><h4> </h4> <div class="m-0" id="visualization"></div></div> <!></div>');function Ss(I,_){On(_,!1);const y=A(),R=A(),et=A(),yt=A(),K=A(),lt=A(),B=A(),D=A(),at=A(),kt=A(),ct=A(),nt=A(),dt=A(),jt=A(),P={COALITION:0,ALLIANCE:1,NATION:2};let _t=A(""),X=A(null),N=A(!1),Q=A(null),mt=A(""),m=A(null),Nt=["GROUND_TANKS_MUNITIONS_USED_UNNECESSARY","DOUBLE_FORTIFY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR","AIRSTRIKE_SOLDIERS_NONE","AIRSTRIKE_SOLDIERS_SHOULD_USE_GROUND","AIRSTRIKE_TANKS_NONE","AIRSTRIKE_SHIP_NONE","AIRSTRIKE_INACTIVE_NO_GROUND","AIRSTRIKE_INACTIVE_NO_SHIP","AIRSTRIKE_FAILED_NOT_DOGFIGHT","AIRSTRIKE_AIRCRAFT_NONE","AIRSTRIKE_AIRCRAFT_NONE_INACTIVE","AIRSTRIKE_AIRCRAFT_LOW","AIRSTRIKE_INFRA","AIRSTRIKE_MONEY","NAVAL_MAX_VS_NONE"].map(e=>`off:${e.toLowerCase().replaceAll("_"," ")} attacks`),S={Summary:{sort:"off:wars",columns:["name","net:damage","off:wars","def:wars","dealt:damage","loss:damage"]},Dealt:{sort:"dealt:damage",columns:["name","dealt:infra","dealt:~$soldier","dealt:~$tank","dealt:~$aircraft","dealt:~$ship","dealt:~$unit","dealt:~$consume","dealt:~$loot","dealt:damage"]},Received:{sort:"loss:damage",columns:["name","loss:infra","loss:~$soldier","loss:~$tank","loss:~$aircraft","loss:~$ship","loss:~$unit","loss:~$consume","loss:~$loot","loss:damage"]},Units:{sort:"dealt:~$unit",columns:["name","dealt:soldier","dealt:tank","dealt:aircraft","dealt:ship","dealt:~$unit","loss:soldier","loss:tank","loss:aircraft","loss:ship","loss:~$unit","net:~$unit"]},Consumption:{sort:"name",columns:["name","loss:~$building","loss:gasoline","loss:munitions","loss:steel","loss:aluminum","loss:consume gas","loss:consume mun"]},Attacks:{sort:"off:attacks",columns:["name","off:attacks",...Nt]}},l=A({layout:P.COALITION,columns:S.Summary.columns,sort:S.Summary.sort,order:"desc"}),Z;const Ct=()=>Xo(),Yt=[{id:"preset-duration",kind:"preset",key:"duration"},{id:"preset-total-dmg",kind:"preset",key:"damage-total"},{id:"preset-net-gap",kind:"preset",key:"net-gap"}],Ut=[{id:"rank-alliance-net",kind:"ranking",entity:"alliance",metric:"net:damage",scope:"all",limit:8},{id:"rank-nation-net",kind:"ranking",entity:"nation",metric:"net:damage",scope:"all",limit:10}],H={duration:"Duration",wars:"Wars tracked","damage-total":"Total damage exchanged","net-gap":"Damage gap","c1-dealt":"Coalition 1 dealt","c2-dealt":"Coalition 2 dealt","off-wars-per-nation":"Offensive wars per nation"},bt={all:"All",coalition1:"Coalition 1",coalition2:"Coalition 2",selection:"Selection snapshot"},St=[...Yt,...Ut];let T=A([...St]),Jt=A([]),ka=A([]),Ca=A([]),Ot=A(null),Rt=A(!1),Ie=new Set,Ne=new Set,Se=A("No selection"),xe=A("nation"),qt=A("net:damage"),Et=A("all"),Ae=A(10),ke=A("nation"),Xt=A("net:damage"),Kt=A("all"),Ce=A("sum"),Oe=A("");const we=()=>`${ye()}:kpi-collapsed`;function Dt(e){return e==null||isNaN(e)?"N/A":e.toLocaleString()}function $t(e){return si(e)}function Bt(){if(!t(X))return;const e=Nn(t(X));e.widgets=t(T),ii(t(X),e)}function Oa(e){if(!e||typeof e!="object"||!Array.isArray(e.widgets))return;const a=e.widgets.map(n=>li(n,$t)).filter(n=>n!==null);a.length>0&&p(T,a)}function En(){try{if(!t(X))return;const e=Nn(t(X));Array.isArray(e.widgets)&&e.widgets.length>0&&Oa({widgets:e.widgets})}catch(e){console.warn("Failed to read KPI config",e)}}function wa(e){p(T,t(T).filter(a=>a.id!==e)),Bt()}function Ta(e,a){p(T,ci(t(T),e,a)),Bt()}function Kn(e,a){p(T,di(t(T),e,a)),Bt()}function Dn(e){p(Ot,e)}function Pn(){p(Ot,null)}function Mn(e){if(!t(Ot)||t(Ot)===e){p(Ot,null);return}const a=t(T).findIndex(n=>n.id===e);if(a===-1){p(Ot,null);return}Kn(t(Ot),a),p(Ot,null)}function Te(){const e=Array.from(Ie),a=Array.from(Ne),n=[];return e.length>0&&n.push(`${e.length} alliance${e.length===1?"":"s"}`),a.length>0&&n.push(`${a.length} nation${a.length===1?"":"s"}`),{allianceIds:e,nationIds:a,label:n.length>0?n.join(" · "):"No selection"}}function Fn(e,a){return e!=="selection"?bt[e]:a!=null&&a.label?`Selection (${a.label})`:bt.selection}function de(e){return e!=="selection"?!0:Ie.size>0||Ne.size>0}function La(e){return t(T).some(a=>a.kind==="preset"&&a.key===e)}function Ra(e,a){var v,o,g;const n=new Set,i=new Set;if(e===P.ALLIANCE)for(const f of a){const b=Number((v=f==null?void 0:f[0])==null?void 0:v[1]);Number.isFinite(b)&&n.add(b)}else if(e===P.NATION)for(const f of a){const b=Number((o=f==null?void 0:f[0])==null?void 0:o[1]),h=Number((g=f==null?void 0:f[0])==null?void 0:g[2]);Number.isFinite(b)&&i.add(b),Number.isFinite(h)&&n.add(h)}else if(t(m)&&e===P.COALITION)for(const f of a){const b=Number(f==null?void 0:f[0]);if(!Number.isFinite(b))continue;const h=t(m).coalitions[b];if(h){for(const x of h.alliance_ids)n.add(x);for(const x of h.nation_ids)i.add(x)}}Ie=n,Ne=i;const s=Te();p(Se,s.label)}function Le(e){p(T,[...t(T),e]),Bt()}function zn(e){La(e)||Le({id:$t("preset"),kind:"preset",key:e})}function Wn(){const e=t(Et)==="selection"?Te():void 0;t(Et)==="selection"&&!de(t(Et))||Le({id:$t("ranking"),kind:"ranking",entity:t(xe),metric:t(qt),scope:t(Et),limit:Math.max(1,t(Ae)),snapshot:e})}function jn(){const e=t(Kt)==="selection"?Te():void 0;t(Kt)==="selection"&&!de(t(Kt))||Le({id:$t("metric"),kind:"metric",entity:t(ke),metric:t(Xt),scope:t(Kt),aggregation:t(Ce),source:"conflict",normalizeBy:t(Oe)||null,snapshot:e})}function Un(){p(Rt,!t(Rt)),localStorage.setItem(we(),t(Rt)?"1":"0")}function $n(){t(Rt)&&(p(Rt,!1),localStorage.setItem(we(),"0"))}let ie=new Map,ue=new Map,xt=new Map;function Bn(){ie.clear(),ue.clear(),xt.clear()}function Vn(e){var i,s,v,o;if(!e)return"-";const a=(s=(i=e.allianceIds)==null?void 0:i.join("."))!=null?s:"",n=(o=(v=e.nationIds)==null?void 0:v.join("."))!=null?o:"";return`${a}|${n}`}function Ea(e){return e==="alliance"?t(ct):t(nt)}function Re(e,a){return Number(e==null?void 0:e[a])||0}function Ka(e,a,n,i=!1){var g,f;if(i&&a===-1)return Number.isFinite(n)?Math.abs(n)<=100&&`${n}`.includes(".")?n.toLocaleString(void 0,{maximumFractionDigits:2}):n.toLocaleString():"0";const v=((f=(g=e==null?void 0:e.cell_format)==null?void 0:g.formatMoney)!=null?f:[]).includes(a),o=Number(n||0).toLocaleString(void 0,{maximumFractionDigits:2});return v?`$${o}`:o}function Da(e,a,n,i){var f,b,h,x,O,M;const s=`${e}|${a}|${Vn(i)}`,v=ie.get(s);if(v)return v;let o;if(a==="all")return n.data;if(a==="selection"){const G=new Set((f=i==null?void 0:i.allianceIds)!=null?f:[]),ft=new Set((b=i==null?void 0:i.nationIds)!=null?b:[]);return e==="alliance"?G.size===0?o=[]:o=n.data.filter(V=>{var Y;const ot=Number((Y=V[0])==null?void 0:Y[1]);return G.has(ot)}):ft.size>0?o=n.data.filter(V=>{var Y;const ot=Number((Y=V[0])==null?void 0:Y[1]);return ft.has(ot)}):G.size>0?o=n.data.filter(V=>{var Y;const ot=Number((Y=V[0])==null?void 0:Y[2]);return G.has(ot)}):o=[],ie.set(s,o),o}if(!t(m))return o=n.data,ie.set(s,o),o;const g=a==="coalition1"?new Set((x=(h=t(m).coalitions[0])==null?void 0:h.alliance_ids)!=null?x:[]):new Set((M=(O=t(m).coalitions[1])==null?void 0:O.alliance_ids)!=null?M:[]);return o=n.data.filter(G=>{var V,ot;if(e==="alliance"){const Y=Number((V=G[0])==null?void 0:V[1]);return g.has(Y)}const ft=Number((ot=G[0])==null?void 0:ot[2]);return g.has(ft)}),ie.set(s,o),o}function Gn(e){const a=ue.get(e.id);if(a)return a;let n;if(e.source==="aava")return!e.aavaSnapshot||e.entity!=="alliance"?[]:t(m)?(n=Sn(t(m),{header:e.aavaSnapshot.header,primaryIds:e.aavaSnapshot.primaryIds,vsIds:e.aavaSnapshot.vsIds}).map(o=>({label:o.alliance[0],allianceId:o.alliance[1],value:Re(o,e.metric)})).sort((o,g)=>g.value-o.value).map(o=>ha(ga({},o),{valueText:Ka(null,-1,o.value,!0)})).slice(0,Math.max(1,e.limit)),ue.set(e.id,n),n):[];const i=Ea(e.entity);if(!i)return[];const s=i.columns.indexOf(e.metric);return s===-1?[]:(n=Da(e.entity,e.scope,i,e.snapshot).map(o=>{var b,h,x,O,M;if(e.entity==="alliance"){const G=Number((b=o[0])==null?void 0:b[1]);return{label:oe((h=o[0])==null?void 0:h[0],G),allianceId:G,value:Number(o[s])||0}}const g=Number((x=o[0])==null?void 0:x[1]),f=Number((O=o[0])==null?void 0:O[2]);return{label:xa((M=o[0])==null?void 0:M[0],g),nationId:g,allianceName:oe(Ke[f],f),allianceId:f,value:Number(o[s])||0}}).sort((o,g)=>g.value-o.value).map(o=>ha(ga({},o),{valueText:Ka(i,s,o.value)})).slice(0,Math.max(1,e.limit)),ue.set(e.id,n),n)}function Qn(e){const a=xt.get(e.id);if(a!==void 0)return a;let n=null;if(e.source==="aava"){if(!e.aavaSnapshot||e.entity!=="alliance"||!t(m))return null;const f=Sn(t(m),{header:e.aavaSnapshot.header,primaryIds:e.aavaSnapshot.primaryIds,vsIds:e.aavaSnapshot.vsIds}),b=f.map(x=>Re(x,e.metric));if(b.length===0)return null;if(e.normalizeBy){const x=f.map(M=>Re(M,e.normalizeBy));if(e.aggregation==="sum"){const M=b.reduce((ft,V)=>ft+V,0),G=x.reduce((ft,V)=>ft+V,0);return n=G===0?null:M/G,xt.set(e.id,n),n}const O=b.map((M,G)=>{const ft=x[G];return ft===0?null:M/ft}).filter(M=>M!=null);return O.length===0?(xt.set(e.id,null),null):(n=O.reduce((M,G)=>M+G,0)/O.length,xt.set(e.id,n),n)}const h=b.reduce((x,O)=>x+O,0);return n=e.aggregation==="avg"?h/b.length:h,xt.set(e.id,n),n}const i=Ea(e.entity);if(!i)return null;const s=i.columns.indexOf(e.metric);if(s===-1)return null;const v=Da(e.entity,e.scope,i,e.snapshot),o=v.map(f=>Number(f[s])||0);if(o.length===0)return null;if(e.normalizeBy){const f=i.columns.indexOf(e.normalizeBy);if(f===-1)return null;const b=v.map(x=>Number(x[f])||0);if(e.aggregation==="sum"){const x=o.reduce((M,G)=>M+G,0),O=b.reduce((M,G)=>M+G,0);return n=O===0?null:x/O,xt.set(e.id,n),n}const h=o.map((x,O)=>{const M=b[O];return M===0?null:x/M}).filter(x=>x!=null);return h.length===0?(xt.set(e.id,null),null):(n=h.reduce((x,O)=>x+O,0)/h.length,xt.set(e.id,n),n)}const g=o.reduce((f,b)=>f+b,0);return n=e.aggregation==="avg"?g/o.length:g,xt.set(e.id,n),n}function Pt(e){return Rn(e)}function Pa(e){var a,n;if(e.source==="aava"){const i=(n=(a=e.aavaSnapshot)==null?void 0:a.header)!=null?n:"wars";return Wt(e.metric,i)}return Pt(e.metric)}function Ma(e){var a,n;if(!e.normalizeBy)return null;if(e.source==="aava"){const i=(n=(a=e.aavaSnapshot)==null?void 0:a.header)!=null?n:"wars";return Wt(e.normalizeBy,i)}return Pt(e.normalizeBy)}function me(e){var a,n;if((e.kind==="ranking"||e.kind==="metric")&&e.source==="aava"){const i=((a=e.aavaSnapshot)==null?void 0:a.label)||"AAvA snapshot",s=((n=e.aavaSnapshot)==null?void 0:n.header)||"wars";return`AAvA (${i} · ${s})`}return e.kind==="preset"?"Preset":Fn(e.scope,e.snapshot)}function Hn(e){if(e.kind==="preset")return H[e.key];if(e.kind==="ranking")return`${e.entity} · ${Pa(e)} · ${me(e)} · top ${e.limit}`;const a=Ma(e)?` per ${Ma(e)}`:"";return`${e.aggregation.toUpperCase()} ${e.entity} · ${Pa(e)}${a} · ${me(e)}`}function Yn(e,a,n,i,s){p(_t,e.name);const v=Ht(e,a,n,i,s);let o=e.coalitions,g=new Set(o[0].alliance_ids),f=new Set(o[1].alliance_ids);a===P.COALITION?v.row_format=(h,x)=>{let O=x[0];O==0?h.classList.add("bg-danger-subtle"):O==1&&h.classList.add("bg-info-subtle")}:a===P.ALLIANCE?v.row_format=(h,x)=>{let O=x[0][1];g.has(O)?h.classList.add("bg-danger-subtle"):f.has(O)&&h.classList.add("bg-info-subtle")}:a===P.NATION&&(v.row_format=(h,x)=>{let O=x[0][2];g.has(O)?h.classList.add("bg-danger-subtle"):f.has(O)&&h.classList.add("bg-info-subtle")}),v.onSelectionChange=h=>{Ra(a,h.selectedRows)},Ra(a,[]),Z=v;const b=document.getElementById("conflict-table-1");ai(b,Z)}function Jn(e){let a=e.get("layout");a&&(a==="coalition"?rt(l,t(l).layout=P.COALITION):a==="alliance"||a==="1"?rt(l,t(l).layout=P.ALLIANCE):(a==="nation"||a==="2")&&rt(l,t(l).layout=P.NATION));let n=e.get("sort");n&&rt(l,t(l).sort=n);let i=e.get("order");i&&rt(l,t(l).order=i);let s=e.get("columns");s&&rt(l,t(l).columns=s.split("."));const v=$o("kpiw",e.get("kpiw"));if(v)try{const o=ri(v,$t);o.length>0&&p(T,o)}catch(o){console.warn("Failed to parse KPI widgets from URL",o)}}function se(){t(m)&&Yn(t(m),t(l).layout,t(l).columns,t(l).sort,t(l).order)}function Ee(e=t(T)){return oi(e,$t)}function ve(){return{layout:P.COALITION,sort:S.Summary.sort,order:"desc",columns:S.Summary.columns.join("."),kpiw:Ee(St)}}function qn(){const e=Ee();ge({layout:t(l).layout,sort:t(l).sort,order:t(l).order,columns:t(l).columns.join("."),kpiw:e},{replace:!0,defaults:ve()}),ae()}function Fa(e=!1){ge({layout:t(l).layout,sort:t(l).sort,order:t(l).order,columns:t(l).columns.join(".")},{replace:e,defaults:ve()})}function Xn(e=!0){const a=Ee();ge({layout:t(l).layout,sort:t(l).sort,order:t(l).order,columns:t(l).columns.join("."),kpiw:a},{replace:e,defaults:ve()})}function za(e){return e.map(a=>{const s=a,{id:n}=s;return gn(s,["id"])})}function Wa(e){p(Q,null),p(N,!1);let a=`https://locutus.s3.ap-southeast-2.amazonaws.com/conflicts/${e}.gzip?${Ia.version.conflict_data}`;yn(a).then(n=>hn(null,null,function*(){p(m,n),p(mt,Jo(Ia.version.conflict_data,n.update_ms)),ja(n.coalitions[0].alliance_ids,n.coalitions[0].alliance_names),ja(n.coalitions[1].alliance_ids,n.coalitions[1].alliance_names),yield qo(),se(),n.posts&&Object.keys(n.posts).length&&ao(n.posts),p(N,!0),ae(),(typeof window.requestIdleCallback=="function"?s=>window.requestIdleCallback(s,{timeout:2500}):s=>window.setTimeout(s,300))(()=>{const s=Zo(e,Ia.version.graph_data);yn(s).catch(()=>{})})})).catch(n=>{console.error("Failed to load conflict data",n),p(Q,"Could not load conflict data. Please try again later."),p(N,!0)})}let Ke={};function ja(e,a){for(let n=0;n<e.length;n++)Ke[e[n]]=oe(a[n],e[n])}Cn(()=>{jo(["layout","sort","order","columns","kpiw"],["id"]),ni(),le("getIds",(n,i)=>{var s;return(s=t(m))==null?void 0:s.coalitions[i]}),le("formatNation",n=>{let i=n[2],s=oe(Ke[i],i),v=xa(n[0],n[1]);return'<a href="https://politicsandwar.com/alliance/id='+n[2]+'">'+s+'</a> | <a href="https://politicsandwar.com/nation/id='+n[1]+'">'+v+"</a>"}),le("formatAA",n=>{let i=n[1],s=oe(n[0],i);return'<a href="https://politicsandwar.com/alliance/id='+i+'">'+s+"</a>"}),le("formatCol",n=>{let i=n,s=document.createElement("button");return t(m)?(s.setAttribute("type","button"),s.setAttribute("class","ms-1 btn ux-btn btn-sm fw-bold"),s.setAttribute("onclick",`showNames('${t(m).coalitions[i].name}',${i})`),s.textContent=t(m).coalitions[i].name,s.outerHTML):""}),le("download",function(i,s){Yo(document.getElementById("conflict-table-1").querySelector("table"),i,ti[s])});const e=Uo();Jn(e),p(Rt,localStorage.getItem(we())==="1");const a=e.get("id");a?(p(X,a),En(),Wa(t(X))):(p(Q,"Missing conflict id in URL"),p(N,!0))});function Zn(e){rt(l,t(l).layout=e),ge({layout:t(l).layout,sort:null,columns:null},{defaults:ve()}),ae(),se()}function to(){rt(l,t(l).layout=P.COALITION),rt(l,t(l).columns=S.Summary.columns),rt(l,t(l).sort=S.Summary.sort),rt(l,t(l).order="desc"),p(T,[...St]),Bt(),Wo(["layout","sort","order","columns","kpiw"],["id"]),Xn(!0),ae(),se()}function eo(){t(X)&&Wa(t(X))}let Ua=!1,fe=null;function $a(){const e=document.getElementById("visjs");if(Ua&&fe&&(e&&e.getAttribute("data-loaded")||typeof Ct()!="undefined")){if(!t(m))return;const a=document.getElementById("visualization");if(!a)return;a.hasChildNodes()&&(a.innerHTML="");const n=Ct(),i=new n.DataSet;for(const f in fe){const b=fe[f],h=b[0],x=`https://forum.politicsandwar.com/index.php?/topic/${h}-${b[1]}`,O=b[2],M=new Date(O);i.add({id:h,content:`<a href="${x}" target="_blank">${f}</a>`,start:M})}const s=t(m).start;let v=t(m).end;v===-1&&(v=Date.now());const o={start:s,end:v,height:"75vh",width:"100%",zoomKey:"ctrlKey",orientation:"top",verticalScroll:!0},g=new n.Timeline(a,i,o);g.addCustomTime(s,"t1"),g.addCustomTime(v,"t2")}}function ao(e){fe=e,Ua=!0,$a()}function no(e){e.target.setAttribute("data-loaded","true"),$a()}tt(()=>t(l),()=>{p(y,t(l).layout===P.ALLIANCE?"Alliance":t(l).layout===P.NATION?"Nation":"Coalition")}),tt(()=>t(T),()=>{const e=[],a=[],n=[];for(const i of t(T))i.kind==="preset"?e.push(i):i.kind==="ranking"?a.push(i):i.kind==="metric"&&n.push(i);p(Jt,e),p(ka,a),p(Ca,n)}),tt(()=>(t(m),In),()=>{p(R,(()=>{if(!t(m))return"N/A";const e=t(m).start,a=t(m).end===-1?Date.now():t(m).end;return e?In(Math.max(0,Math.round((a-e)/1e3))):"N/A"})())}),tt(()=>(t(m),Ht),()=>{p(et,t(m)?Ht(t(m),P.COALITION,S.Summary.columns,"name","asc"):null)}),tt(()=>(t(m),Ht),()=>{p(yt,t(m)?Ht(t(m),P.NATION,S.Summary.columns,"name","asc"):null)}),tt(()=>(t(m),t(et)),()=>{p(K,(()=>{if(!t(m)||!t(et))return null;const e=t(m),a=t(et),n=a.columns.indexOf("dealt:damage"),i=a.columns.indexOf("loss:damage"),s=a.columns.indexOf("net:damage"),v=a.columns.indexOf("off:wars"),o=a.columns.indexOf("def:wars");return n===-1||i===-1||s===-1||v===-1||o===-1?null:a.data.slice(0,2).map((g,f)=>{var b,h;return{idx:f,name:(h=(b=e.coalitions[f])==null?void 0:b.name)!=null?h:`Coalition ${f+1}`,dealt:Number(g[n])||0,received:Number(g[i])||0,net:Number(g[s])||0,wars:(Number(g[v])||0)+(Number(g[o])||0)}})})())}),tt(()=>t(K),()=>{p(lt,t(K)?t(K).reduce((e,a)=>e+a.dealt,0):null)}),tt(()=>t(K),()=>{p(B,t(K)?Math.max(...t(K).map(e=>e.wars)):null)}),tt(()=>t(K),()=>{p(D,t(K)?Math.max(...t(K).map(e=>Math.abs(e.net))):null)}),tt(()=>t(yt),()=>{p(at,(()=>{if(!t(yt))return null;const e=t(yt),a=e.columns.indexOf("off:wars");if(a===-1)return null;const n=e.data.length;if(n===0)return null;const i=e.data.reduce((s,v)=>s+(Number(v[a])||0),0);return{totalOffWars:i,totalNations:n,perNation:i/n}})())}),tt(()=>t(K),()=>{p(kt,t(K)?t(K).reduce((e,a)=>a.net>e.net?a:e,t(K)[0]):null)}),tt(()=>(t(m),t(l)),()=>{p(ct,t(m)?Ht(t(m),P.ALLIANCE,t(l).columns,t(l).sort,t(l).order):null)}),tt(()=>(t(m),t(l)),()=>{p(nt,t(m)?Ht(t(m),P.NATION,t(l).columns,t(l).sort,t(l).order):null)}),tt(()=>t(nt),()=>{p(dt,t(nt)?t(nt).columns.filter((e,a)=>{var s,v,o,g;if(a===0)return!1;const n=(v=(s=t(nt).cell_format)==null?void 0:s.formatMoney)!=null?v:[],i=(g=(o=t(nt).cell_format)==null?void 0:o.formatNumber)!=null?g:[];return n.includes(a)||i.includes(a)}):[])}),tt(()=>(t(dt),t(qt),t(Xt)),()=>{t(dt).length>0&&(t(dt).includes(t(qt))||p(qt,t(dt)[0]),t(dt).includes(t(Xt))||p(Xt,t(dt)[0]))}),tt(()=>(t(m),t(ct),t(nt),t(T)),()=>{t(m),t(ct),t(nt),t(T),Bn()}),tt(()=>(t(l),t(T)),()=>{p(jt,(()=>{const e=S.Summary.columns,a=t(l).columns.length===e.length&&t(l).columns.every((o,g)=>o===e[g]),n=t(l).layout===P.COALITION&&t(l).sort===S.Summary.sort&&t(l).order==="desc"&&a,i=JSON.stringify(za(t(T))),s=JSON.stringify(za(St));return!(n&&i===s)})())}),Po(),kn();var De=os();zo("mkmkyj",e=>{var a=xi(),n=ht(a);d(n),Mo(()=>{var i;Fo.title=`Conflict ${(i=t(_t))!=null?i:""}`}),q("load",n,no),k(e,a)});var Pe=c(De),Me=c(Pe),Ba=c(Me);{let e=ee(()=>[{label:"Home",href:`${Sa}/`},{label:"Conflicts",href:`${Sa}/conflicts`},{label:t(_t)||"Conflict",href:t(X)?`${Sa}/conflict?id=`+t(X):void 0},{label:t(y)}]);Qo(Ba,{get items(){return t(e)}})}var Va=d(Ba,2),oo=c(Va);r(Va),r(Me);var io=d(Me,2);{var so=e=>{var a=Ai(),n=c(a);ya(),r(a),E(()=>{var i,s;re(a,"href",`https://politicsandwar.fandom.com/wiki/${(i=(t(m),u(()=>t(m).wiki)))!=null?i:""}`),w(n,`Wiki:${(s=(t(m),u(()=>{var v;return(v=t(m))==null?void 0:v.wiki})))!=null?s:""} `)}),k(e,a)};J(io,e=>{t(m),u(()=>{var a;return(a=t(m))==null?void 0:a.wiki})&&e(so)})}r(Pe);var Ga=d(Pe,2);Go(Ga,{get conflictId(){return t(X)},mode:"layout-picker",get currentLayout(){return t(l),u(()=>t(l).layout)},active:"coalition",onLayoutSelect:Zn});var Fe=d(Ga,2),Qa=d(c(Fe),2);Tt(Qa,1,()=>u(()=>Object.keys(S)),Lt,(e,a)=>{var n=ki(),i=c(n),s=c(i,!0);r(i),r(n),E(()=>{var v;Na(i,1,`btn ux-btn btn-sm ms-1 fw-bold ${(v=(t(l),t(a),u(()=>t(l).columns===S[t(a)].columns?"active":"")))!=null?v:""}`),w(s,t(a))}),q("click",i,()=>{rt(l,t(l).columns=S[t(a)].columns),rt(l,t(l).sort=S[t(a)].sort),Fa(),ae(),se()}),k(e,n)});var ze=d(Qa,2),ro=c(ze);{let e=ee(()=>(t(Jt),u(()=>t(Jt).map(n=>n.key)))),a=ee(()=>({widgets:t(T),presetCards:t(Jt),rankingCards:t(ka),metricCards:t(Ca)}));Si(ro,{get currentColumns(){return t(l),u(()=>t(l).columns)},get currentSort(){return t(l),u(()=>t(l).sort)},get currentOrder(){return t(l),u(()=>t(l).order)},get currentKpis(){return t(e)},get currentKpiConfig(){return t(a)},$$events:{load:n=>{const i=n.detail.preset;if(rt(l,t(l).columns=i.columns),i.sort&&rt(l,t(l).sort=i.sort),i.order&&rt(l,t(l).order=i.order),i.kpiConfig)Oa(i.kpiConfig),Bt();else if(Array.isArray(i.kpis)&&i.kpis.length>0){const s=i.kpis.filter(v=>v in H).map(v=>v);s.length>0&&(p(T,s.map(v=>({id:$t("preset"),kind:"preset",key:v}))),Bt())}Fa(),ae(),se()}}})}r(ze);var Ha=d(ze,2);{var lo=e=>{var a=Ci(),n=c(a);r(a),q("click",n,$n),k(e,a)};J(Ha,e=>{t(Rt)&&e(lo)})}var We=d(Ha,2),Ya=d(c(We),2),Ja=d(c(Ya),2);{var co=e=>{var a=Oi();k(e,a)};J(Ja,e=>{t(T),u(()=>t(T).length===0)&&e(co)})}var qa=d(Ja,2);Tt(qa,1,()=>t(T),Lt,(e,a,n)=>{var i=wi(),s=c(i),v=c(s,!0);r(s);var o=d(s,2),g=c(o);g.disabled=n===0;var f=d(g,2),b=d(f,2);r(o),r(i),E(h=>{w(v,h),f.disabled=(t(T),u(()=>n===t(T).length-1))},[()=>(t(a),u(()=>Hn(t(a))))]),q("click",g,zt(ne(()=>Ta(t(a).id,-1)))),q("click",f,zt(ne(()=>Ta(t(a).id,1)))),q("click",b,zt(ne(()=>wa(t(a).id)))),k(e,i)});var je=d(qa,6);Tt(je,5,()=>u(()=>Object.keys(H)),Lt,(e,a)=>{const n=ee(()=>t(a));var i=Ti(),s=c(i);r(i),E(v=>{var o;i.disabled=v,w(s,`+ ${(o=(Qt(t(n)),u(()=>H[t(n)])))!=null?o:""}`)},[()=>(Qt(t(n)),u(()=>La(t(n))))]),q("click",i,zt(ne(()=>zn(t(n))))),k(e,i)}),r(je);var Ue=d(je,6),$e=c(Ue),Be=c($e),Ve=c(Be);Ve.value=Ve.__value="alliance";var Xa=d(Ve);Xa.value=Xa.__value="nation",r(Be),r($e);var Ge=d($e,2),Qe=c(Ge),He=c(Qe);He.value=He.__value="all";var Ye=d(He);Ye.value=Ye.__value="coalition1";var Je=d(Ye);Je.value=Je.__value="coalition2";var pe=d(Je),uo=c(pe);r(pe),pe.value=pe.__value="selection",r(Qe),r(Ge);var qe=d(Ge,2),Za=c(qe);Tn(Za),r(qe);var Xe=d(qe,2),Ze=c(Xe);Tt(Ze,5,()=>t(dt),Lt,(e,a)=>{var n=Li(),i=c(n,!0);r(n);var s={};E(v=>{var o;w(i,v),s!==(s=t(a))&&(n.value=(o=n.__value=t(a))!=null?o:"")},[()=>(t(a),u(()=>Pt(t(a))))]),k(e,n)}),r(Ze),r(Xe);var tn=d(Xe,2),en=c(tn);r(tn),r(Ue);var ta=d(Ue,6),ea=c(ta),aa=c(ea),na=c(aa);na.value=na.__value="alliance";var an=d(na);an.value=an.__value="nation",r(aa),r(ea);var oa=d(ea,2),ia=c(oa),sa=c(ia);sa.value=sa.__value="all";var ra=d(sa);ra.value=ra.__value="coalition1";var la=d(ra);la.value=la.__value="coalition2";var _e=d(la),mo=c(_e);r(_e),_e.value=_e.__value="selection",r(ia),r(oa);var ca=d(oa,2),da=c(ca),ua=c(da);ua.value=ua.__value="sum";var nn=d(ua);nn.value=nn.__value="avg",r(da),r(ca);var ma=d(ca,2),va=c(ma);Tt(va,5,()=>t(dt),Lt,(e,a)=>{var n=Ri(),i=c(n,!0);r(n);var s={};E(v=>{var o;w(i,v),s!==(s=t(a))&&(n.value=(o=n.__value=t(a))!=null?o:"")},[()=>(t(a),u(()=>Pt(t(a))))]),k(e,n)}),r(va),r(ma);var fa=d(ma,2),pa=c(fa),_a=c(pa);_a.value=_a.__value="";var vo=d(_a);Tt(vo,1,()=>t(dt),Lt,(e,a)=>{var n=Ei(),i=c(n);r(n);var s={};E(v=>{var o;w(i,`Per ${v!=null?v:""}`),s!==(s=t(a))&&(n.value=(o=n.__value=t(a))!=null?o:"")},[()=>(t(a),u(()=>Pt(t(a))))]),k(e,n)}),r(pa),r(fa);var on=d(fa,2),sn=c(on);r(on),r(ta);var fo=d(ta,4);{var po=e=>{var a=Ki();E(()=>re(a,"href",`aava?id=${t(X)}`)),k(e,a)};J(fo,e=>{t(X)&&e(po)})}r(Ya),r(We);var rn=d(We,2),_o=c(rn);Ho(_o,{onReset:to,onSharePrepare:qn,get resetDirty(){return t(jt)}}),r(rn),r(Fe);var ln=d(Fe,2);{var bo=e=>{var a=Xi(),n=c(a),i=d(c(n),2);r(n);var s=d(n,2);Tt(s,5,()=>t(T),Lt,(v,o)=>{const g=ee(()=>(t(o),u(()=>t(o).kind==="ranking")));var f=qi(),b=c(f);let h;var x=c(b),O=d(x,2);{var M=V=>{var ot=Eo(),Y=ht(ot);{var Vt=U=>{var $=Di(),F=d(ht($),2),it=c(F,!0);r(F),E(()=>w(it,t(R))),k(U,$)},Zt=U=>{var $=Pi(),F=d(ht($),2),it=c(F,!0);r(F),E(z=>w(it,z),[()=>(t(B),u(()=>Dt(t(B))))]),k(U,$)},te=U=>{var $=Mi(),F=d(ht($),2),it=c(F,!0);r(F),E(z=>w(it,z),[()=>(t(lt),u(()=>Dt(t(lt))))]),k(U,$)},vt=U=>{var $=zi(),F=d(ht($),2),it=c(F,!0);r(F);var z=d(F,2);{var L=W=>{var j=Fi(),gt=c(j);r(j),E(()=>{var st;return w(gt,`Lead: ${(st=(t(kt),u(()=>t(kt).name)))!=null?st:""}`)}),k(W,j)};J(z,W=>{t(kt)&&W(L)})}E(W=>w(it,W),[()=>(t(D),u(()=>Dt(t(D))))]),k(U,$)},ut=U=>{var $=Wi(),F=ht($),it=c(F);r(F);var z=d(F,2),L=c(z,!0);r(z),E(W=>{var j;w(it,`${(j=(t(K),u(()=>{var gt,st,It;return(It=(st=(gt=t(K))==null?void 0:gt[0])==null?void 0:st.name)!=null?It:"Coalition 1"})))!=null?j:""} dealt`),w(L,W)},[()=>(t(K),u(()=>{var W,j;return Dt((j=(W=t(K))==null?void 0:W[0])==null?void 0:j.dealt)}))]),k(U,$)},Mt=U=>{var $=ji(),F=ht($),it=c(F);r(F);var z=d(F,2),L=c(z,!0);r(z),E(W=>{var j;w(it,`${(j=(t(K),u(()=>{var gt,st,It;return(It=(st=(gt=t(K))==null?void 0:gt[1])==null?void 0:st.name)!=null?It:"Coalition 2"})))!=null?j:""} dealt`),w(L,W)},[()=>(t(K),u(()=>{var W,j;return Dt((j=(W=t(K))==null?void 0:W[1])==null?void 0:j.dealt)}))]),k(U,$)},wt=U=>{var $=$i(),F=d(ht($),2),it=c(F,!0);r(F);var z=d(F,2);{var L=W=>{var j=Ui(),gt=c(j);r(j),E((st,It)=>w(gt,`${st!=null?st:""}
                                            offensive / ${It!=null?It:""}
                                            nations`),[()=>(t(at),u(()=>Dt(t(at).totalOffWars))),()=>(t(at),u(()=>Dt(t(at).totalNations)))]),k(W,j)};J(z,W=>{t(at)&&W(L)})}E(W=>w(it,W),[()=>(t(at),u(()=>t(at)?t(at).perNation.toFixed(2):"N/A"))]),k(U,$)};J(Y,U=>{t(o),u(()=>t(o).key==="duration")?U(Vt):(t(o),u(()=>t(o).key==="wars")?U(Zt,1):(t(o),u(()=>t(o).key==="damage-total")?U(te,2):(t(o),u(()=>t(o).key==="net-gap")?U(vt,3):(t(o),u(()=>t(o).key==="c1-dealt")?U(ut,4):(t(o),u(()=>t(o).key==="c2-dealt")?U(Mt,5):(t(o),u(()=>t(o).key==="off-wars-per-nation")&&U(wt,6)))))))})}k(V,ot)},G=V=>{const ot=ee(()=>(t(o),u(()=>Gn(t(o)))));var Y=Yi(),Vt=ht(Y),Zt=c(Vt);r(Vt);var te=d(Vt,2),vt=c(te),ut=c(vt),Mt=c(ut),wt=d(c(Mt)),U=c(wt,!0);r(wt);var $=d(wt);{var F=z=>{var L=Bi();k(z,L)};J($,z=>{t(o),u(()=>t(o).entity==="nation")&&z(F)})}ya(),r(Mt),r(ut);var it=d(ut);Tt(it,5,()=>t(ot),Lt,(z,L,W)=>{var j=Hi(),gt=c(j);gt.textContent=W+1;var st=d(gt),It=c(st);{var xo=At=>{var pt=Vi(),Gt=c(pt,!0);r(pt),E(()=>{re(pt,"href",(t(L),u(()=>`https://politicsandwar.com/alliance/id=${t(L).allianceId}`))),w(Gt,(t(L),u(()=>t(L).label)))}),k(At,pt)},Ao=At=>{var pt=Gi(),Gt=c(pt,!0);r(pt),E(()=>{re(pt,"href",(t(L),u(()=>`https://politicsandwar.com/nation/id=${t(L).nationId}`))),w(Gt,(t(L),u(()=>t(L).label)))}),k(At,pt)};J(It,At=>{t(o),u(()=>t(o).entity==="alliance")?At(xo):At(Ao,!1)})}r(st);var vn=d(st);{var ko=At=>{var pt=Qi(),Gt=c(pt),Oo=c(Gt,!0);r(Gt),r(pt),E(()=>{re(Gt,"href",(t(L),u(()=>`https://politicsandwar.com/alliance/id=${t(L).allianceId}`))),w(Oo,(t(L),u(()=>t(L).allianceName)))}),k(At,pt)};J(vn,At=>{t(o),u(()=>t(o).entity==="nation")&&At(ko)})}var fn=d(vn),Co=c(fn,!0);r(fn),r(j),E(()=>w(Co,(t(L),u(()=>t(L).valueText)))),k(z,j)}),r(it),r(vt),r(te),E((z,L)=>{var W,j;w(Zt,`Top ${(W=(t(o),u(()=>t(o).limit)))!=null?W:""}
                                    ${(j=(t(o),u(()=>t(o).entity)))!=null?j:""}s by
                                    ${z!=null?z:""}
                                    (${L!=null?L:""})`),w(U,(t(o),u(()=>t(o).entity==="alliance"?"Alliance":"Nation")))},[()=>(t(o),Qt(Wt),u(()=>{var z,L;return t(o).source==="aava"?Wt(t(o).metric,(L=(z=t(o).aavaSnapshot)==null?void 0:z.header)!=null?L:"wars"):Pt(t(o).metric)})),()=>(t(o),u(()=>me(t(o))))]),k(V,Y)},ft=V=>{var ot=Ji(),Y=ht(ot),Vt=c(Y);r(Y);var Zt=d(Y,2),te=c(Zt,!0);r(Zt),E((vt,ut,Mt,wt,U)=>{var $;w(Vt,`${vt!=null?vt:""}
                                    ${($=(t(o),u(()=>t(o).entity)))!=null?$:""}
                                    ${ut!=null?ut:""}
                                    ${Mt!=null?Mt:""}
                                    (${wt!=null?wt:""})`),w(te,U)},[()=>(t(o),u(()=>t(o).aggregation.toUpperCase())),()=>(t(o),Qt(Wt),u(()=>{var vt,ut;return t(o).source==="aava"?Wt(t(o).metric,(ut=(vt=t(o).aavaSnapshot)==null?void 0:vt.header)!=null?ut:"wars"):Pt(t(o).metric)})),()=>(t(o),Qt(Wt),u(()=>{var vt,ut;return t(o).normalizeBy?` per ${t(o).source==="aava"?Wt(t(o).normalizeBy,(ut=(vt=t(o).aavaSnapshot)==null?void 0:vt.header)!=null?ut:"wars"):Pt(t(o).normalizeBy)}`:""})),()=>(t(o),u(()=>me(t(o)))),()=>(t(o),u(()=>Dt(Qn(t(o)))))]),k(V,ot)};J(O,V=>{t(o),u(()=>t(o).kind==="preset")?V(M):(t(o),u(()=>t(o).kind==="ranking")?V(G,1):V(ft,!1))})}r(b),r(f),E(()=>{Na(f,1,Bo(t(g)?"col-12 col-lg-6":"col-12 col-sm-6 col-xl-4")),h=Na(b,1,"ux-surface p-3 rounded border h-100 position-relative kpi-card",null,h,{"kpi-card-dragging":t(Ot)===t(o).id})}),q("click",x,()=>wa(t(o).id)),q("dragstart",b,()=>Dn(t(o).id)),q("dragend",b,Pn),q("dragover",b,zt(function(V){Vo.call(this,_,V)})),q("drop",b,zt(()=>Mn(t(o).id))),k(v,f)}),r(s),r(a),q("click",i,Un),k(e,a)};J(ln,e=>{t(m)&&!t(Rt)&&e(bo)})}var cn=d(ln,2);{var go=e=>{ei(e)};J(cn,e=>{t(N)||e(go)})}var dn=d(cn,2);{var ho=e=>{var a=Zi(),n=c(a),i=c(n,!0);r(n);var s=d(n,2);r(a),E(()=>w(i,t(Q))),q("click",s,eo),k(e,a)};J(dn,e=>{t(Q)&&e(ho)})}var un=d(dn,4);{var yo=e=>{var a=as(),n=d(ht(a),2),i=c(n);{var s=g=>{var f=ts(),b=c(f),h=d(c(b),2),x=c(h,!0);r(h),r(b),r(f),E(()=>w(x,(t(m),u(()=>{var O;return(O=t(m))==null?void 0:O.cb})))),k(g,f)};J(i,g=>{t(m),u(()=>{var f;return(f=t(m))==null?void 0:f.cb})&&g(s)})}var v=d(i,2);{var o=g=>{var f=es(),b=c(f),h=d(c(b),2),x=c(h,!0);r(h),r(b),r(f),E(()=>w(x,(t(m),u(()=>{var O;return(O=t(m))==null?void 0:O.status})))),k(g,f)};J(v,g=>{t(m),u(()=>{var f;return(f=t(m))==null?void 0:f.status})&&g(o)})}r(n),k(e,a)};J(un,e=>{t(l),u(()=>t(l).layout==P.COALITION)&&e(yo)})}var ba=d(un,4),mn=c(ba),Io=c(mn);r(mn),ya(2),r(ba);var No=d(ba,2);{var So=e=>{var a=ns(),n=c(a,!0);r(a),E(()=>w(n,t(mt))),k(e,a)};J(No,e=>{t(mt)&&e(So)})}r(De),E((e,a,n,i)=>{var s,v,o;w(oo,`Conflict: ${(s=t(_t))!=null?s:""}`),w(uo,`Selection snapshot (${(v=t(Se))!=null?v:""})`),en.disabled=e,w(mo,`Selection snapshot (${(o=t(Se))!=null?o:""})`),sn.disabled=a,w(Io,`${n!=null?n:""} - ${i!=null?i:""}`)},[()=>(t(Et),u(()=>!de(t(Et)))),()=>(t(Kt),u(()=>!de(t(Kt)))),()=>(Qt(he),t(m),u(()=>{var e,a;return he((a=(e=t(m))==null?void 0:e.start)!=null?a:null)})),()=>(Qt(he),t(m),u(()=>{var e,a;return he((a=(e=t(m))==null?void 0:e.end)!=null?a:null)}))]),Ft(Be,()=>t(xe),e=>p(xe,e)),Ft(Qe,()=>t(Et),e=>p(Et,e)),Ln(Za,()=>t(Ae),e=>p(Ae,e)),Ft(Ze,()=>t(qt),e=>p(qt,e)),q("click",en,zt(ne(Wn))),Ft(aa,()=>t(ke),e=>p(ke,e)),Ft(ia,()=>t(Kt),e=>p(Kt,e)),Ft(da,()=>t(Ce),e=>p(Ce,e)),Ft(va,()=>t(Xt),e=>p(Xt,e)),Ft(pa,()=>t(Oe),e=>p(Oe,e)),q("click",sn,zt(ne(jn))),k(I,De),wn()}export{Ss as component};
