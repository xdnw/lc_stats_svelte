import{a as R,t as $,b as na}from"../chunks/disclose-version.xy21-f78.js";import{i as ia}from"../chunks/legacy.N0bfMBuo.js";import{p as ra,f as mt,t as E,b as ca,g as t,s as w,c,$ as da,m as M,d as g,e as _,r as f,n as kt,i as Dt}from"../chunks/runtime.DMLHWUus.js";import{h as ua,e as k,s as L}from"../chunks/render.CoimT3AH.js";import{o as ma,i as D}from"../chunks/index-client.D_ywJSmp.js";import{N as _a,e as fa,F as pa,i as ba,s as P}from"../chunks/Footer.C7bm1xTi.js";import{a as va,p as ha,q as Na,d as Ia,f as ga,s as X,h as C,j as Aa,E as Oa,r as wa,u as J,i as ya,v as Ta,w as Sa,x as Ra,y as Ut}from"../chunks/index.DcoiBfme.js";import{c as Kt}from"../chunks/_layout.BJmI2Ulo.js";var Ea=na('<script id="visjs" async src="https://cdnjs.cloudflare.com/ajax/libs/vis-timeline/7.7.3/vis-timeline-graph2d.min.js"><\/script><!---->',1),La=$('<a class="btn ux-btn fw-bold"> <i class="bi bi-box-arrow-up-right"></i></a>'),Ca=$("<li><button> </button></li>"),$a=$('<div class="alert alert-danger m-2 d-flex justify-content-between align-items-center"><span> </span> <button class="btn btn-sm btn-outline-danger fw-bold">Retry</button></div>'),xa=$('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Casus Belli</h3> <pre> </pre></div></div>'),ka=$('<div class="col-md-6 col-sm-12"><div class="col-md-12 ms-2 p-2 rounded border ux-surface"><h3>Status</h3> <pre> </pre></div></div>'),Da=$('<hr> <div class="row m-0"><!> <!></div>',1),Ua=$('<div class="small text-muted mt-1"> </div>'),Ka=$("<p> </p>"),Ma=$('<!> <div class="container-fluid p-2" style="min-height: calc(100vh - 203px);"><h1 class="m-0 mb-2 p-2 ux-surface ux-page-title"><a href="conflicts" aria-label="Back to conflicts"><i class="bi bi-arrow-left"></i></a> <!></h1> <hr class="mt-2 mb-2"> <div class="row p-0 m-0 ux-tabstrip fw-bold"><button id="profile-pill">‚óë&nbsp;Coalition</button> <button id="alliance-pill">ñ£Ø&nbsp;Alliance</button> <button id="nation-pill">‚ôü&nbsp;Nation</button> <a class="col-2 ps-0 pe-0 btn">üìä&nbsp;Tier/Time</a> <a class="col-2 ps-0 pe-0 btn">üìà&nbsp;Bubble/Time</a> <a class="col-2 ps-0 pe-0 btn">üåê&nbsp;Web</a></div> <ul class="nav fw-bold nav-pills nav-fill m-0 p-2 ux-surface mb-3"><li>Layout Picker:</li> <!></ul> <!> <!> <div class="d-flex gap-1 mb-2"><button class="btn ux-btn btn-sm fw-bold">Copy share link</button> <button class="btn ux-btn btn-sm fw-bold">Reset</button></div> <div id="conflict-table-1"></div> <!> <hr> <div class="ux-surface p-2"><h4> </h4> <div class="m-0" id="visualization"></div></div> <!></div> <!> <!>',1);function Ya(Mt,Pt){ra(Pt,!1);const v={COALITION:0,ALLIANCE:1,NATION:2};let Z=M(""),U=M(null),B=M(!1),G=M(null),tt=M(""),u=M(null),Ft=["GROUND_TANKS_MUNITIONS_USED_UNNECESSARY","DOUBLE_FORTIFY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY","GROUND_NO_TANKS_MUNITIONS_USED_UNNECESSARY_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR_INACTIVE","GROUND_TANKS_NO_LOOT_NO_ENEMY_AIR","AIRSTRIKE_SOLDIERS_NONE","AIRSTRIKE_SOLDIERS_SHOULD_USE_GROUND","AIRSTRIKE_TANKS_NONE","AIRSTRIKE_SHIP_NONE","AIRSTRIKE_INACTIVE_NO_GROUND","AIRSTRIKE_INACTIVE_NO_SHIP","AIRSTRIKE_FAILED_NOT_DOGFIGHT","AIRSTRIKE_AIRCRAFT_NONE","AIRSTRIKE_AIRCRAFT_NONE_INACTIVE","AIRSTRIKE_AIRCRAFT_LOW","AIRSTRIKE_INFRA","AIRSTRIKE_MONEY","NAVAL_MAX_VS_NONE"].map(s=>`off:${s.toLowerCase().replaceAll("_"," ")} attacks`),x={Summary:{sort:"off:wars",columns:["name","net:damage","off:wars","def:wars","dealt:damage","loss:damage"]},Dealt:{sort:"dealt:damage",columns:["name","dealt:infra","dealt:~$soldier","dealt:~$tank","dealt:~$aircraft","dealt:~$ship","dealt:~$unit","dealt:~$consume","dealt:~$loot","dealt:damage"]},Received:{sort:"loss:damage",columns:["name","loss:infra","loss:~$soldier","loss:~$tank","loss:~$aircraft","loss:~$ship","loss:~$unit","loss:~$consume","loss:~$loot","loss:damage"]},Units:{sort:"dealt:~$unit",columns:["name","dealt:soldier","dealt:tank","dealt:aircraft","dealt:ship","dealt:~$unit","loss:soldier","loss:tank","loss:aircraft","loss:ship","loss:~$unit","net:~$unit"]},Consumption:{sort:"name",columns:["name","loss:~$building","loss:gasoline","loss:munitions","loss:steel","loss:aluminum","loss:consume gas","loss:consume mun"]},Attacks:{sort:"off:attacks",columns:["name","off:attacks",...Ft]}},l=M({layout:v.COALITION,columns:x.Summary.columns,sort:x.Summary.sort,order:"desc"}),_t;const ft=()=>window.vis;function jt(s,a,e,o,r){w(Z,s.name);let i=s.coalitions,m=s.damage_header,p=s.header_type,I=[],d=[],A=[],y=[],T={},F=null,Ct=new Set(i[0].alliance_ids),$t=new Set(i[1].alliance_ids);switch(a){case v.COALITION:F=(n,b,O)=>{let h=b[0];h==0?n.classList.add("bg-danger-subtle"):h==1&&n.classList.add("bg-info-subtle")};break;case v.ALLIANCE:F=(n,b,O)=>{let h=b[0][1];Ct.has(h)?n.classList.add("bg-danger-subtle"):$t.has(h)&&n.classList.add("bg-info-subtle")};break;case v.NATION:F=(n,b,O)=>{let h=b[0][2];Ct.has(h)?n.classList.add("bg-danger-subtle"):$t.has(h)&&n.classList.add("bg-info-subtle")};break}{d.push("name");for(let n=0;n<m.length;(n+=1)-1){let b=Sa(m[n]),O=p[n];O==0?(d.push("loss:"+b),d.push("dealt:"+b.replace("_loss","").replace("loss_","")),d.push("net:"+b.replace("_loss","").replace("loss_",""))):O==1&&(d.push("def:"+b),d.push("off:"+b),d.push("both:"+b))}A.push(0)}let ea=[d.indexOf(o),r];T.formatNumber=[],T.formatMoney=[];for(let n=0;n<d.length;(n+=1)-1)e.includes(d[n])&&y.push(n),n>0&&(d[n].includes("~")||d[n].includes("damage")||d[n].includes("infra")&&!d[n].includes("attacks")?T.formatMoney.push(n):T.formatNumber.push(n));let rt=(n,b,O)=>{for(let h=0;h<b.length;(h+=1)-1){let j=b[h],V=O[h],ct=p[h],S;ct==0?S=V-j:S=V+j,n.push(j),n.push(V),n.push(S)}},sa=(n,b)=>{let O=n.alliance_ids,h=n.alliance_names,j=n.nation_ids,V=n.nation_names,ct=n.nation_aa,S=n.damage;switch(a){case v.COALITION:T.formatCol=[0];let xt=[b];rt(xt,S[0],S[1]),I.push(xt);break;case v.ALLIANCE:{T.formatAA=[0];let z=2;for(let N=0;N<O.length;(N+=1)-1){let K=[],dt=O[N],ut=h[N];K.push([ut,dt]),rt(K,S[N*2+z],S[N*2+z+1]),I.push(K)}break}case v.NATION:{T.formatNation=[0];let z=2+O.length*2;for(let N=0;N<j.length;(N+=1)-1){let K=[],dt=j[N],ut=V[N],la=ct[N];K.push([ut,dt,la]),rt(K,S[N*2+z],S[N*2+z+1]),I.push(K)}break}}};for(let n=0;n<i.length;(n+=1)-1){let b=i[n];sa(b,n)}_t={columns:d,data:I,visible:y,searchable:A,cell_format:T,row_format:F,sort:ea};const oa=document.getElementById("conflict-table-1");Ra(oa,_t)}function Bt(s){let a=s.get("layout");a&&(a==="coalition"?g(l,t(l).layout=v.COALITION):a==="alliance"||a==="1"?g(l,t(l).layout=v.ALLIANCE):(a==="nation"||a==="2")&&g(l,t(l).layout=v.NATION));let e=s.get("sort");e&&g(l,t(l).sort=e);let o=s.get("order");o&&g(l,t(l).order=o);let r=s.get("columns");r&&g(l,t(l).columns=r.split("."))}function H(){t(u)&&jt(t(u),t(l).layout,t(l).columns,t(l).sort,t(l).order)}function pt(s){w(G,null),w(B,!1);let a=`https://locutus.s3.ap-southeast-2.amazonaws.com/conflicts/${s}.gzip?${Kt.version.conflict_data}`;Ia(a).then(e=>{const o=e;w(u,o),w(tt,ga(Kt.version.conflict_data,o.update_ms)),vt(o.coalitions[0].alliance_ids,o.coalitions[0].alliance_names),vt(o.coalitions[1].alliance_ids,o.coalitions[1].alliance_names),H(),o.posts&&Object.keys(o.posts).length&&zt(o.posts),w(B,!0),X()}).catch(e=>{console.error("Failed to load conflict data",e),w(G,"Could not load conflict data. Please try again later."),w(B,!0)})}let bt={};function vt(s,a){for(let e=0;e<s.length;(e+=1)-1)bt[s[e]]=a[e]}ma(()=>{va(["layout","sort","order","columns"],["id"]),ha(),window.getIds=(e,o)=>{var r;return(r=t(u))==null?void 0:r.coalitions[o]},window.formatNation=(e,o,r,i)=>{let m=e[2],p=bt[m];return'<a href="https://politicsandwar.com/alliance/id='+e[2]+'">'+p+'</a> | <a href="https://politicsandwar.com/nation/id='+e[1]+'">'+(e[0]?e[0]:e[1])+"</a>"},window.formatAA=(e,o,r,i)=>'<a href="https://politicsandwar.com/alliance/id='+e[1]+'">'+e[0]+"</a>",window.formatCol=(e,o,r,i)=>{let m=e,p=document.createElement("button");return t(u)?(p.setAttribute("type","button"),p.setAttribute("class","ms-1 btn ux-btn btn-sm fw-bold"),p.setAttribute("onclick",`showNames('${t(u).coalitions[m].name}',${m})`),p.textContent=t(u).coalitions[m].name,p.outerHTML):""},window.download=function(o,r){Na(document.getElementById("conflict-table-1").querySelector("table"),o,Oa[r])};let s=new URLSearchParams(window.location.search);Bt(s);const a=s.get("id");a?(w(U,a),pt(t(U))):(w(G,"Missing conflict id in URL"),w(B,!0))});function at(s){g(l,t(l).layout=parseInt(s.target.getAttribute("data-bs-layout"))),C("layout",t(l).layout),C("sort",null),C("columns",null),X(),H()}function Gt(){g(l,t(l).layout=v.COALITION),g(l,t(l).columns=x.Summary.columns),g(l,t(l).sort=x.Summary.sort),g(l,t(l).order="desc"),wa(["layout","sort","order","columns"],["id"]),C("layout",t(l).layout,{replace:!0}),C("sort",t(l).sort,{replace:!0}),C("order",t(l).order,{replace:!0}),C("columns",t(l).columns.join("."),{replace:!0}),X(),H()}function Vt(){t(U)&&pt(t(U))}let ht=!1,Y=null;function Nt(){const s=document.getElementById("visjs");if(ht&&Y&&(s&&s.getAttribute("data-loaded")||typeof ft()!="undefined")){if(!t(u))return;console.log("Initializing timeline");const a=document.getElementById("visualization");if(!a)return;a.hasChildNodes()&&(a.innerHTML="");const e=ft(),o=new e.DataSet;for(const I in Y){const d=Y[I],A=d[0],y=`https://forum.politicsandwar.com/index.php?/topic/${A}-${d[1]}`,T=d[2],F=new Date(T);o.add({id:A,content:`<a href="${y}" target="_blank">${I}</a>`,start:F})}const r=t(u).start;let i=t(u).end;i===-1&&(i=Date.now());const m={start:r,end:i,height:"75vh",width:"100%",zoomKey:"ctrlKey",orientation:"top",verticalScroll:!0},p=new e.Timeline(a,o,m);p.addCustomTime(r,"t1"),p.addCustomTime(i,"t2")}}function zt(s){Y=s,ht=!0,console.log("Posts loaded"),Nt()}function Ht(s){console.log("Script loaded"),s.target.setAttribute("data-loaded","true"),Nt()}ia();var It=Ma();ua(s=>{var a=Ea(),e=mt(a),o=c(e);E(()=>{var r;return da.title=`Conflict ${(r=t(Z))!=null?r:""}`}),k("load",e,Ht),R(s,a)});var gt=mt(It);_a(gt,{});var et=c(gt,2),st=_(et),At=c(_(st)),Yt=c(At);D(Yt,()=>{var s;return(s=t(u))==null?void 0:s.wiki},s=>{var a=La(),e=_(a);kt(),f(a),E(()=>{var o,r,i;P(a,"href",`https://politicsandwar.fandom.com/wiki/${(o=t(u).wiki)!=null?o:""}`),L(e,`Wiki:${(i=(r=t(u))==null?void 0:r.wiki)!=null?i:""}¬†`)}),R(s,a)}),f(st);var ot=c(st,4),Q=_(ot),W=c(Q,2),q=c(W,2),Ot=c(q,2),wt=c(Ot,2),Qt=c(wt,2);f(ot);var lt=c(ot,2),Wt=c(_(lt),2);fa(Wt,1,()=>Object.keys(x),ba,(s,a)=>{var e=Ca(),o=_(e),r=_(o,!0);f(o),f(e),E(()=>{var i;J(o,`btn ux-btn btn-sm ms-1 fw-bold ${(i=t(l).columns===x[t(a)].columns?"active":"")!=null?i:""}`),L(r,t(a))}),k("click",o,()=>{g(l,t(l).columns=x[t(a)].columns),g(l,t(l).sort=x[t(a)].sort),C("sort",t(l).sort),C("columns",t(l).columns.join(".")),X(),H()}),R(s,e)}),f(lt);var yt=c(lt,2);D(yt,()=>!t(B),s=>{ya(s)});var Tt=c(yt,2);D(Tt,()=>t(G),s=>{var a=$a(),e=_(a),o=_(e,!0);f(e);var r=c(e,2);f(a),E(()=>L(o,t(G))),k("click",r,Vt),R(s,a)});var nt=c(Tt,2),St=_(nt),qt=c(St,2);f(nt);var Rt=c(nt,4);D(Rt,()=>t(l).layout==v.COALITION,s=>{var a=Da(),e=c(mt(a),2),o=_(e);D(o,()=>{var i;return(i=t(u))==null?void 0:i.cb},i=>{var m=xa(),p=_(m),I=c(_(p),2),d=_(I);f(I),f(p),f(m),E(()=>{var A,y;return L(d,`
                ${(y=(A=t(u))==null?void 0:A.cb)!=null?y:""}
            `)}),R(i,m)});var r=c(o,2);D(r,()=>{var i;return(i=t(u))==null?void 0:i.status},i=>{var m=ka(),p=_(m),I=c(_(p),2),d=_(I);f(I),f(p),f(m),E(()=>{var A,y;return L(d,`
                ${(y=(A=t(u))==null?void 0:A.status)!=null?y:""}
            `)}),R(i,m)}),f(e),R(s,a)});var it=c(Rt,4),Et=_(it);const Xt=Dt(()=>{var s,a,e;return(e=Ut((a=(s=t(u))==null?void 0:s.start)!=null?a:null))!=null?e:""}),Jt=Dt(()=>{var s,a,e;return(e=Ut((a=(s=t(u))==null?void 0:s.end)!=null?a:null))!=null?e:""});var Zt=_(Et);E(()=>L(Zt,`${t(Xt)} - ${t(Jt)}`)),f(Et),kt(2),f(it);var ta=c(it,2);D(ta,()=>t(tt),s=>{var a=Ua(),e=_(a,!0);f(a),E(()=>L(e,t(tt))),R(s,a)}),f(et);var Lt=c(et,2);D(Lt,()=>t(u)&&t(u).update_ms,s=>{var a=Ka(),e=_(a);E(()=>{var o;return L(e,`Last updated ${(o=Ta(Math.round((Date.now()-t(u).update_ms)/1e3)))!=null?o:""} ago`)}),f(a),R(s,a)});var aa=c(Lt,2);pa(aa,{}),E(()=>{var s,a,e,o,r,i,m;L(At,`¬†Conflict: ${(s=t(Z))!=null?s:""} `),J(Q,`col-2 ps-0 pe-0 btn ${(a=t(l).layout==v.COALITION?"is-active":"")!=null?a:""}`),P(Q,"data-bs-layout",v.COALITION),J(W,`col-2 btn ps-0 pe-0 ${(e=t(l).layout==v.ALLIANCE?"is-active":"")!=null?e:""}`),P(W,"data-bs-layout",v.ALLIANCE),J(q,`col-2 ps-0 pe-0 btn ${(o=t(l).layout==v.NATION?"is-active":"")!=null?o:""}`),P(q,"data-bs-layout",v.NATION),P(Ot,"href",`tiering?id=${(r=t(U))!=null?r:""}`),P(wt,"href",`bubble?id=${(i=t(U))!=null?i:""}`),P(Qt,"href",`chord?id=${(m=t(U))!=null?m:""}`)}),k("click",Q,at),k("click",W,at),k("click",q,at),k("click",St,()=>Aa()),k("click",qt,Gt),R(Mt,It),ca()}export{Ya as component};
