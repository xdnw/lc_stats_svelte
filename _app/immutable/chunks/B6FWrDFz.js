import{c as xe,a as A,s as L,e as E,f as M}from"./ByHfNYyH.js";import{i as He}from"./DPmMxCJa.js";import{c as Je}from"./TrlPcG3m.js";import{p as Qe,l as I,a as Te,i as ue,b as Ue,j as ee,g as e,e as m,f as We,m as g,c as u,r as d,s as h,u as T,n as Xe,t as z}from"./MAWq1Bs-.js";import{i as P}from"./DRn8owhI.js";import{e as Ye,i as Ze}from"./D5oqsy_p.js";import{r as Se,s as te,e as $e}from"./CnrOJzGS.js";import{v as et,w as tt}from"./BrECN6iW.js";import{p as w,b as at}from"./BTi-TpZb.js";function B(a){if(typeof a=="number")return Number.isFinite(a)?a:null;if(typeof a=="string"){const t=a.trim();if(t.length===0)return null;const i=Number(t);if(Number.isFinite(i))return i;const p=t.match(/-?\d+(?:\.\d+)?/);if(!p)return null;const b=Number(p[0]);return Number.isFinite(b)?b:null}return null}function nt(a){if(!a)return{};if(Array.isArray(a)){const t={};return a.forEach((i,p)=>{t[String(p)]=i}),t}return a}function rt(a){return typeof Set!="undefined"&&a instanceof Set}function lt(a){return typeof Map!="undefined"&&a instanceof Map}function U(a){return a!==null}function ke(a){return a==null||typeof a=="string"?a:void 0}function it(a){const t=a==null?void 0:a.alliance_ids,i=a==null?void 0:a.alliance_names;if(!t)return[];if(Array.isArray(t)){const c=Array.isArray(i)?i:[];return t.map((s,f)=>{const o=B(s);return o===null?null:{id:o,name:c[f]}}).filter(U)}if(rt(t)){const c=Array.isArray(i)?i:[];return Array.from(t).map((s,f)=>{const o=B(s);return o===null?null:{id:o,name:c[f]}}).filter(U)}if(lt(t)){const c=Array.from(t.entries()).map(s=>{let[f,o]=s;var W;const X=(W=B(f))!=null?W:B(o);return X===null?null:{id:X,name:typeof o=="string"?o:null}}).filter(U);if(c.length>0)return c}const p=t,b=nt(i),C=Object.entries(p),S=C.map(c=>{let[s,f]=c;const o=B(f);return o===null?null:{key:s,id:o,name:ke(b[s])}}).filter(U);return S.length>0?S.map(c=>{let{id:s,name:f}=c;return{id:s,name:f}}):C.map(c=>{let[s,f]=c;const o=B(s);return o===null?null:{id:o,name:typeof f=="string"?f:ke(b[s])}}).filter(U)}function At(a){return a.map(t=>B(t)).filter(t=>t!==null&&Number.isFinite(t))}function wt(a){var t;if(a.length===0)return null;const i="".concat((t=a[0])!=null?t:"").trim();return i.length>0?i:null}function Ct(a,t){return a.length===1?null:"Select exactly one ".concat(t,".")}function Nt(a){return a.map(t=>({id:t,label:t}))}function It(a,t){var i;const p=[];for(const b of a!=null?a:[]){const C=it(b),S="".concat((i=b==null?void 0:b.name)!=null?i:"Coalition");C.forEach(K=>{let{id:c,name:s}=K;p.push({id:c,label:t("".concat(s!=null?s:""),c),group:S})})}return p}var st=M('<div class="ux-callout mb-2"> </div>'),ot=M('<div class="d-flex flex-wrap gap-2 align-items-center mb-2"><button class="btn ux-btn btn-sm" type="button">Select All</button> <button class="btn ux-btn btn-sm" type="button">Clear</button> <span class="small ux-muted"> </span></div>'),ct=M('<div class="small ux-muted mb-2"> </div>'),ut=M('<div class="alert alert-warning py-2 small mb-2"> </div>'),dt=M('<div class="ux-muted small">No items match your search.</div>'),ft=M('<span class="badge text-bg-light"> </span>'),mt=M('<label class="form-check d-flex align-items-center gap-2 mb-1"><input class="form-check-input mt-0"/> <span> </span> <!></label>'),vt=M('<div class="modal fade show d-block" tabindex="-1" role="dialog" aria-modal="true"><div class="modal-dialog modal-lg modal-dialog-scrollable" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"> </h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><!> <input type="text" class="form-control mb-2"/> <!> <!> <div class="ux-surface p-2 selection-modal-list svelte-16b0rgt"><!></div></div> <div class="modal-footer"><button class="btn btn-outline-secondary">Cancel</button> <button class="btn ux-btn"> </button></div></div></div></div> <div class="modal-backdrop fade show"></div>',1);function Lt(a,t){Qe(t,!1);const i=g(),p=g(),b=g(),C=g(),S=g();let K=w(t,"open",8,!1),c=w(t,"title",8,"Select Items"),s=w(t,"description",8,""),f=w(t,"items",24,()=>[]),o=w(t,"selectedIds",24,()=>[]),W=w(t,"searchPlaceholder",8,"Search..."),X=w(t,"applyLabel",8,"Apply"),ae=w(t,"selectedCountLabel",8,"Selected"),j=w(t,"singleSelect",8,!1),ne=w(t,"validateSelection",8,null);const de=Je();let D=g(""),x=g(new Set),re=g(new Map),le=g(!1),Y=g(null),F=g([]),ie=g([]);function fe(r){const _=r==null?void 0:r.label;return typeof _=="string"?_:_==null?`${r.id}`:`${_}`}function V(r){return`${typeof r}:${r}`}function Ae(r){const _=V(r),y=j()?new Set:new Set(e(x));if(y.has(_))y.delete(_);else if(y.add(_),j())for(const q of Array.from(y))q!==_&&y.delete(q);m(x,y)}function we(){m(x,new Set(e(F).map(r=>V(r.id))))}function Ce(){m(x,new Set)}function Z(){de("close")}function Ne(){e(S)||de("apply",{ids:e(C)})}I(()=>ee(f()),()=>{m(F,Array.isArray(f())?f():[])}),I(()=>ee(o()),()=>{m(ie,Array.isArray(o())?o():[])}),I(()=>e(F),()=>{m(re,new Map(e(F).map(r=>[V(r.id),r.id])))}),I(()=>(ee(K()),e(le),e(ie),e(Y)),()=>{K()&&!e(le)&&(m(x,new Set(e(ie).map(r=>V(r)))),m(D,""),We().then(()=>{var r;(r=e(Y))==null||r.focus()})),m(le,K())}),I(()=>e(D),()=>{m(i,e(D).trim().toLowerCase())}),I(()=>(e(F),e(i)),()=>{m(p,e(F).filter(r=>fe(r).toLowerCase().includes(e(i))))}),I(()=>e(x),()=>{m(b,e(x).size)}),I(()=>(e(x),e(re)),()=>{m(C,Array.from(e(x)).map(r=>e(re).get(r)).filter(r=>r!==void 0))}),I(()=>(ee(ne()),e(C)),()=>{m(S,ne()?ne()(e(C)):null)}),Te(),He();var me=xe(),Ie=ue(me);{var Le=r=>{var _=vt(),y=ue(_),q=u(y),ve=u(q),se=u(ve),oe=u(se),Ee=u(oe,!0);d(oe);var Me=h(oe,2);d(se);var ce=h(se,2),pe=u(ce);{var Ke=n=>{var l=st(),k=u(l,!0);d(l),z(()=>L(k,s())),A(n,l)};P(pe,n=>{s()&&n(Ke)})}var G=h(pe,2);Se(G),at(G,n=>m(Y,n),()=>e(Y));var be=h(G,2);{var Re=n=>{var l=ot(),k=u(l),R=h(k,2),v=h(R,2),H=u(v);d(v),d(l),z(()=>{var N,O;return L(H,`${(N=ae())!=null?N:""}: ${(O=e(b))!=null?O:""}`)}),E("click",k,we),E("click",R,Ce),A(n,l)},ze=n=>{var l=ct(),k=u(l);d(l),z(()=>{var R,v;return L(k,`${(R=ae())!=null?R:""}: ${(v=e(b))!=null?v:""}`)}),A(n,l)};P(be,n=>{j()?n(ze,!1):n(Re)})}var _e=h(be,2);{var Be=n=>{var l=ut(),k=u(l,!0);d(l),z(()=>L(k,e(S))),A(n,l)};P(_e,n=>{e(S)&&n(Be)})}var ye=h(_e,2),Fe=u(ye);{var Oe=n=>{var l=dt();A(n,l)},Pe=n=>{var l=xe(),k=ue(l);Ye(k,1,()=>e(p),Ze,(R,v)=>{var H=mt(),N=u(H);Se(N);var O=h(N,2),De=u(O,!0);d(O);var Ve=h(O,2);{var qe=J=>{var Q=ft(),Ge=u(Q,!0);d(Q),z(()=>L(Ge,(e(v),T(()=>e(v).group)))),A(J,Q)};P(Ve,J=>{e(v),T(()=>e(v).group)&&J(qe)})}d(H),z((J,Q)=>{te(N,"type",j()?"radio":"checkbox"),te(N,"name",j()?"selection-modal-single":void 0),$e(N,J),L(De,Q)},[()=>(e(x),e(v),T(()=>e(x).has(V(e(v).id)))),()=>(e(v),T(()=>fe(e(v))))]),E("change",N,()=>Ae(e(v).id)),A(R,H)}),A(n,l)};P(Fe,n=>{e(p),T(()=>e(p).length===0)?n(Oe):n(Pe,!1)})}d(ye),d(ce);var ge=h(ce,2),he=u(ge),$=h(he,2),je=u($);d($),d(ge),d(ve),d(q),d(y),Xe(2),z(()=>{var n,l;te(y,"aria-label",c()),L(Ee,c()),te(G,"placeholder",W()),$.disabled=!!e(S),L(je,`${(n=X())!=null?n:""} (${(l=e(b))!=null?l:""})`)}),E("click",Me,Z),et(G,()=>e(D),n=>m(D,n)),E("click",he,Z),E("click",$,Ne),E("click",y,tt(Z)),E("keydown",y,n=>{n.key==="Escape"&&Z()}),A(r,_)};P(Ie,r=>{K()&&r(Le)})}A(a,me),Ue()}export{Lt as S,It as a,Nt as b,wt as f,At as t,Ct as v};
